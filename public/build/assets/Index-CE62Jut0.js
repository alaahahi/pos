import{s as O,x as q,g as V,a as u,h as z,w as h,b as t,i as _,d,t as n,u as b,p as x,l as w,y as k,A as G,c as f,f as A,F as Y,e as H}from"./app-CHz4vJ2a.js";import{_ as J}from"./AuthenticatedLayout-JX5hdPrS.js";import{_ as K}from"./Pagination-BqwtJI86.js";import{l as P}from"./lodash-CBezKv3Y.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"pagetitle dark:text-white"},W={class:"breadcrumb"},X={class:"breadcrumb-item"},Z={class:"section dashboard"},tt={class:"row mb-4"},st={class:"col-xl-3 col-md-6"},et={class:"card info-card sales-card"},lt={class:"card-body"},nt={class:"d-flex align-items-center"},ot={class:"ps-3"},it={class:"col-xl-3 col-md-6"},at={class:"card info-card revenue-card"},rt={class:"card-body"},dt={class:"d-flex align-items-center"},ct={class:"ps-3"},ut={class:"col-xl-3 col-md-6"},pt={class:"card info-card customers-card"},mt={class:"card-body"},bt={class:"d-flex align-items-center"},ft={class:"ps-3"},vt={class:"col-xl-3 col-md-6"},ht={class:"card info-card revenue-card"},_t={class:"card-body"},gt={class:"d-flex align-items-center"},xt={class:"ps-3"},yt={class:"card"},wt={class:"card-header d-flex justify-content-between align-items-center"},kt={class:"d-flex gap-2"},It={class:"card-body"},Dt={class:"row mb-4"},Ft={class:"col-md-4"},St={class:"search-box"},Ct={class:"col-md-2"},Mt=["value"],jt={class:"col-md-2"},Vt={class:"col-md-2"},At={class:"table-responsive"},Yt={class:"table table-hover"},Tt={class:"invoice-number"},Bt={key:0,class:"supplier-info"},Nt={class:"text-muted"},Ut={key:1,class:"text-muted"},$t={class:"date-text"},Et={class:"badge bg-info"},Lt={class:"amount-info"},Ot={class:"text-success"},qt={class:"creator-info"},zt={class:"date-text"},Gt={class:"action-buttons"},Ht={class:"btn-group",role:"group"},Jt=["onClick"],Kt={key:0,class:"text-center py-5"},Pt={__name:"Index",props:{purchaseInvoices:Object,suppliers:Array,filters:Object,translations:Object},setup(c){var F,S,C,M;const i=c,I=O(),o=q({search:((F=i.filters)==null?void 0:F.search)||"",supplier_id:((S=i.filters)==null?void 0:S.supplier_id)||"",date_from:((C=i.filters)==null?void 0:C.date_from)||"",date_to:((M=i.filters)==null?void 0:M.date_to)||""}),D=P.debounce(()=>{g()},500),g=()=>{V.get(route("purchase-invoices.index"),o,{preserveState:!0,replace:!0})},T=()=>{o.search="",o.supplier_id="",o.date_from="",o.date_to="",g()},B=l=>l?new Date(l).toLocaleDateString("ar-SA"):"-",N=l=>l?new Date(l).toLocaleString("ar-SA"):"-",U=()=>{var v;if(!((v=i.purchaseInvoices)!=null&&v.data))return"0.00";const l=new Date().getMonth(),s=new Date().getFullYear();return i.purchaseInvoices.data.filter(r=>{const a=new Date(r.invoice_date);return a.getMonth()===l&&a.getFullYear()===s}).reduce((r,a)=>r+parseFloat(a.total_amount),0).toFixed(2)},$=()=>i.suppliers?i.suppliers.length:0,E=()=>{var r,a;if(!((a=(r=i.purchaseInvoices)==null?void 0:r.data)!=null&&a.length))return"0.00";const l=new Date().getMonth(),s=new Date().getFullYear(),p=i.purchaseInvoices.data.filter(e=>{const m=new Date(e.invoice_date);return m.getMonth()===l&&m.getFullYear()===s});return p.length?(p.reduce((e,m)=>e+parseFloat(m.total_amount),0)/p.length).toFixed(2):"0.00"},L=l=>{confirm(`هل أنت متأكد من حذف فاتورة المشتريات رقم ${l.invoice_number}؟`)&&V.delete(route("purchase-invoices.destroy",l.id),{onSuccess:()=>{I.success("تم حذف فاتورة المشتريات بنجاح")},onError:()=>{I.error("حدث خطأ أثناء حذف فاتورة المشتريات")}})};return(l,s)=>(u(),z(J,{translations:c.translations},{default:h(()=>{var p,y,v,r,a;return[t("div",R,[s[6]||(s[6]=t("h1",{class:"dark:text-white"},"فواتير المشتريات",-1)),t("nav",null,[t("ol",W,[t("li",X,[_(b(x),{class:"nav-link dark:text-white",href:l.route("dashboard")},{default:h(()=>[d(n(c.translations.home),1)]),_:1},8,["href"])]),s[5]||(s[5]=t("li",{class:"breadcrumb-item active dark:text-white"},"فواتير المشتريات",-1))])])]),t("section",Z,[t("div",tt,[t("div",st,[t("div",et,[t("div",lt,[s[9]||(s[9]=t("h5",{class:"card-title"},[d("إجمالي الفواتير "),t("span",null,"| جميع الفواتير")],-1)),t("div",nt,[s[8]||(s[8]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-receipt"})],-1)),t("div",ot,[t("h6",null,n(((p=c.purchaseInvoices)==null?void 0:p.total)||0),1),s[7]||(s[7]=t("span",{class:"text-success small pt-1 fw-bold"},"فاتورة",-1))])])])])]),t("div",it,[t("div",at,[t("div",rt,[s[12]||(s[12]=t("h5",{class:"card-title"},[d("إجمالي المشتريات "),t("span",null,"| هذا الشهر")],-1)),t("div",dt,[s[11]||(s[11]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-currency-dollar"})],-1)),t("div",ct,[t("h6",null,n(U()),1),s[10]||(s[10]=t("span",{class:"text-primary small pt-1 fw-bold"},"دينار",-1))])])])])]),t("div",ut,[t("div",pt,[t("div",mt,[s[15]||(s[15]=t("h5",{class:"card-title"},[d("عدد الموردين "),t("span",null,"| نشط")],-1)),t("div",bt,[s[14]||(s[14]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-people"})],-1)),t("div",ft,[t("h6",null,n($()),1),s[13]||(s[13]=t("span",{class:"text-success small pt-1 fw-bold"},"مورد",-1))])])])])]),t("div",vt,[t("div",ht,[t("div",_t,[s[18]||(s[18]=t("h5",{class:"card-title"},[d("متوسط الفاتورة "),t("span",null,"| هذا الشهر")],-1)),t("div",gt,[s[17]||(s[17]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-graph-up"})],-1)),t("div",xt,[t("h6",null,n(E()),1),s[16]||(s[16]=t("span",{class:"text-info small pt-1 fw-bold"},"دينار",-1))])])])])])]),t("div",yt,[t("div",wt,[s[20]||(s[20]=t("h5",{class:"card-title mb-0"},[t("i",{class:"bi bi-receipt me-2"}),d(" إدارة فواتير المشتريات ")],-1)),t("div",kt,[_(b(x),{href:l.route("purchase-invoices.create"),class:"btn btn-primary"},{default:h(()=>s[19]||(s[19]=[t("i",{class:"bi bi-plus-circle"},null,-1),d(" إنشاء فاتورة جديدة ")])),_:1},8,["href"])])]),t("div",It,[t("div",Dt,[t("div",Ft,[t("div",St,[w(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=e=>o.search=e),placeholder:"ابحث برقم الفاتورة أو المورد...",onInput:s[1]||(s[1]=(...e)=>b(D)&&b(D)(...e))},null,544),[[k,o.search]]),s[21]||(s[21]=t("i",{class:"bi bi-search search-icon"},null,-1))])]),t("div",Ct,[w(t("select",{class:"form-select","onUpdate:modelValue":s[2]||(s[2]=e=>o.supplier_id=e),onChange:g},[s[22]||(s[22]=t("option",{value:""},"جميع الموردين",-1)),(u(!0),f(Y,null,A(c.suppliers,e=>(u(),f("option",{key:e.id,value:e.id},n(e.name),9,Mt))),128))],544),[[G,o.supplier_id]])]),t("div",jt,[w(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=e=>o.date_from=e),onChange:g,placeholder:"من تاريخ"},null,544),[[k,o.date_from]])]),t("div",Vt,[w(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=e=>o.date_to=e),onChange:g,placeholder:"إلى تاريخ"},null,544),[[k,o.date_to]])]),t("div",{class:"col-md-2"},[t("button",{class:"btn btn-outline-secondary w-100",onClick:T},s[23]||(s[23]=[t("i",{class:"bi bi-arrow-clockwise"},null,-1),d(" مسح الفلاتر ")]))])]),t("div",At,[t("table",Yt,[s[28]||(s[28]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"رقم الفاتورة"),t("th",null,"المورد"),t("th",null,"تاريخ الفاتورة"),t("th",null,"عدد المنتجات"),t("th",null,"المبلغ الإجمالي"),t("th",null,"أنشأ بواسطة"),t("th",null,"تاريخ الإنشاء"),t("th",{class:"text-center"},"الإجراءات")])],-1)),t("tbody",null,[(u(!0),f(Y,null,A((y=c.purchaseInvoices)==null?void 0:y.data,e=>{var m,j;return u(),f("tr",{key:e.id,class:"invoice-row"},[t("td",null,[t("div",Tt,[t("strong",null,n(e.invoice_number),1)])]),t("td",null,[e.supplier?(u(),f("div",Bt,[t("strong",null,n(e.supplier.name),1),s[24]||(s[24]=t("br",null,null,-1)),t("small",Nt,n(e.supplier.phone),1)])):(u(),f("span",Ut,"غير محدد"))]),t("td",null,[t("span",$t,n(B(e.invoice_date)),1)]),t("td",null,[t("span",Et,n(((m=e.items)==null?void 0:m.length)||0)+" منتج",1)]),t("td",null,[t("div",Lt,[t("strong",Ot,n(e.total_amount.toFixed(2))+" دينار",1)])]),t("td",null,[t("div",qt,[t("strong",null,n((j=e.creator)==null?void 0:j.name),1)])]),t("td",null,[t("span",zt,n(N(e.created_at)),1)]),t("td",null,[t("div",Gt,[t("div",Ht,[_(b(x),{href:l.route("purchase-invoices.show",e.id),class:"btn btn-sm btn-outline-primary",title:"عرض التفاصيل"},{default:h(()=>s[25]||(s[25]=[t("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),_(b(x),{href:l.route("purchase-invoices.edit",e.id),class:"btn btn-sm btn-outline-warning",title:"تعديل"},{default:h(()=>s[26]||(s[26]=[t("i",{class:"bi bi-pencil"},null,-1)])),_:2},1032,["href"]),t("button",{onClick:Qt=>L(e),class:"btn btn-sm btn-outline-danger",title:"حذف"},s[27]||(s[27]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Jt)])])])])}),128))])])]),(r=(v=c.purchaseInvoices)==null?void 0:v.data)!=null&&r.length?H("",!0):(u(),f("div",Kt,[s[30]||(s[30]=t("i",{class:"bi bi-receipt display-1 text-muted"},null,-1)),s[31]||(s[31]=t("h5",{class:"text-muted mt-3"},"لا توجد فواتير مشتريات",-1)),s[32]||(s[32]=t("p",{class:"text-muted"},"ابدأ بإنشاء فاتورة مشتريات جديدة",-1)),_(b(x),{href:l.route("purchase-invoices.create"),class:"btn btn-primary"},{default:h(()=>s[29]||(s[29]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),d(" إنشاء فاتورة جديدة ")])),_:1},8,["href"])]))])]),_(K,{links:(a=c.purchaseInvoices)==null?void 0:a.links},null,8,["links"])])]}),_:1},8,["translations"]))}},ss=Q(Pt,[["__scopeId","data-v-4c5a86e7"]]);export{ss as default};
