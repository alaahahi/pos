import{r as f,s as Q,T as R,k as z,B as A,a as u,h as G,w as L,b as s,d as v,t as o,n as d,j as N,l as c,G as q,u as i,x as p,i as b,c as m,e as h}from"./app-3XmFid0x.js";import{_ as H}from"./AuthenticatedLayout-CB5i1jAM.js";import{_ as g}from"./InputError-BlSIuM29.js";import{l as J}from"./lodash-CJLnPlkJ.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"section dashboard"},X={class:"row"},Y={class:"col-lg-12"},Z={class:"card"},ss={class:"card-header"},ts={class:"card-title mb-0"},es={class:"text-muted mb-0"},ls={class:"card-body"},os={class:"row mb-4"},is={class:"col-12"},as={class:"progress-steps"},ns={class:"step-label"},rs={class:"step-label"},ds={class:"step-label"},cs={class:"step-label"},us={class:"form-section"},ms={class:"section-title"},vs={class:"row mb-3"},ps={for:"inputName",class:"col-sm-2 col-form-label required"},bs={class:"col-sm-10"},gs={class:"input-group"},_s=["placeholder"],fs={class:"form-text"},hs={class:"row mb-3"},xs={for:"inputBarcode",class:"col-sm-2 col-form-label"},ys={class:"col-sm-10"},ws={class:"input-group"},ks=["placeholder"],Vs=["disabled","title"],qs={key:0,class:"input-group-text"},Cs={key:1,class:"input-group-text text-danger"},Bs={key:2,class:"input-group-text text-success"},Is={class:"form-text"},Us={class:"row mb-3"},Ss={for:"inputModel",class:"col-sm-2 col-form-label"},Ns={class:"col-sm-10"},Fs={class:"input-group"},Ms=["placeholder"],Ps={class:"form-text"},js={class:"row mb-3"},Es={for:"inputOENumber",class:"col-sm-2 col-form-label"},$s={class:"col-sm-10"},Ds={class:"input-group"},Ts=["placeholder"],Os={class:"form-text"},Qs={class:"form-section"},Rs={class:"section-title"},zs={class:"row mb-3"},As={for:"inputPriceCost",class:"col-sm-2 col-form-label"},Gs={class:"col-sm-10"},Ls={class:"input-group"},Hs=["placeholder"],Js={class:"input-group-text"},Ks={class:"form-text"},Ws={class:"row mb-3"},Xs={for:"inputPrice",class:"col-sm-2 col-form-label required"},Ys={class:"col-sm-10"},Zs={class:"input-group"},st=["placeholder"],tt={class:"input-group-text"},et={class:"form-text"},lt={key:0,class:"row mb-3"},ot={class:"col-sm-10"},it={class:"alert alert-info"},at={class:"form-section"},nt={class:"section-title"},rt={class:"row mb-3"},dt={for:"inputQuantity",class:"col-sm-2 col-form-label required"},ct={class:"col-sm-10"},ut={class:"input-group"},mt=["placeholder"],vt={class:"input-group-text"},pt={class:"form-text"},bt={class:"form-section"},gt={class:"section-title"},_t={class:"row mb-3"},ft={for:"inputNote",class:"col-sm-2 col-form-label"},ht={class:"col-sm-10"},xt={class:"input-group"},yt=["placeholder"],wt={class:"form-text"},kt={class:"row mb-3"},Vt={for:"inputdate",class:"col-sm-2 col-form-label"},qt={class:"col-sm-10"},Ct={class:"input-group"},Bt={class:"form-text"},It={class:"row mb-3"},Ut={for:"inputImage",class:"col-sm-2 col-form-label"},St={class:"col-sm-10"},Nt={key:0,class:"upload-placeholder"},Ft={class:"text-muted"},Mt={key:1,class:"image-preview"},Pt=["src","alt"],jt=["value"],Et={class:"form-text"},$t={class:"row mt-4"},Dt={class:"col-12"},Tt={class:"d-flex justify-content-between"},Ot=["disabled"],Qt=["disabled"],Rt={key:0,class:"bi bi-check-circle me-2"},zt={key:1,class:"spinner-border spinner-border-sm me-2"},At={__name:"Create",props:{translations:Object},setup(l){const x=f(!1),y=Q(),n=f(1),w=f(null),V=f(null),r=f({checking:!1,isValid:!0,message:""}),k=f(null),C=f(null),e=R({name:"",model:"",oe_number:"",price_cost:null,price:null,quantity:null,notes:"",barcode:"",image:null}),B=z(()=>e.name&&e.price&&e.quantity),F=()=>{n.value<4&&n.value++},M=()=>{n.value>1&&n.value--},I=()=>{n.value===1&&e.name&&(n.value=2)},P=()=>{const _=Date.now().toString(),t=Math.floor(Math.random()*1e3).toString().padStart(3,"0");e.barcode=`BC${_.slice(-6)}${t}`,U(e.barcode),y.success("تم توليد باركود جديد")},j=async _=>{if(!_||_.length<3){r.value={checking:!1,isValid:!0,message:""};return}r.value.checking=!0;try{const a=await(await fetch(route("products.checkBarcodeUnique",_))).json();r.value={checking:!1,isValid:a.unique,message:a.message},a.unique||y.warning(a.message)}catch(t){console.error("Barcode validation error:",t),r.value={checking:!1,isValid:!1,message:"خطأ في التحقق من الباركود"}}},U=J.debounce(j,500),S=()=>{e.price_cost&&e.price?(k.value=parseFloat(e.price)-parseFloat(e.price_cost),C.value=k.value/parseFloat(e.price_cost)*100):(k.value=null,C.value=null)},E=()=>{V.value.click()},$=_=>{const t=_.target.files[0];if(t){e.image=t;const a=new FileReader;a.onload=O=>{w.value=O.target.result},a.readAsDataURL(t)}},D=()=>{e.image=null,w.value=null,V.value&&(V.value.value="")},T=()=>{if(e.barcode&&!r.value.isValid){y.error("يجب إدخال باركود صحيح ومتاح");return}if(!B.value){y.error("يرجى ملء جميع الحقول المطلوبة");return}x.value=!0,e.post(route("products.store"),{onSuccess:()=>{x.value=!1,y.success("تم إنشاء المنتج بنجاح")},onError:()=>{x.value=!1,y.error("حدث خطأ أثناء إنشاء المنتج")}})};return A([()=>e.name,()=>e.price,()=>e.quantity],()=>{I()}),(_,t)=>(u(),G(H,{translations:l.translations},{default:L(()=>[s("section",W,[s("div",X,[s("div",Y,[s("div",Z,[s("div",ss,[s("h5",ts,[t[10]||(t[10]=s("i",{class:"bi bi-plus-circle me-2"},null,-1)),v(" "+o(l.translations.add_new_product),1)]),s("p",es,o(l.translations.add_new_product_description),1)]),s("div",ls,[s("div",os,[s("div",is,[s("div",as,[s("div",{class:d(["step",{active:n.value>=1,completed:n.value>1}])},[t[11]||(t[11]=s("div",{class:"step-number"},"1",-1)),s("div",ns,o(l.translations.basic_info),1)],2),s("div",{class:d(["step",{active:n.value>=2,completed:n.value>2}])},[t[12]||(t[12]=s("div",{class:"step-number"},"2",-1)),s("div",rs,o(l.translations.pricing),1)],2),s("div",{class:d(["step",{active:n.value>=3,completed:n.value>3}])},[t[13]||(t[13]=s("div",{class:"step-number"},"3",-1)),s("div",ds,o(l.translations.inventory),1)],2),s("div",{class:d(["step",{active:n.value>=4,completed:n.value>4}])},[t[14]||(t[14]=s("div",{class:"step-number"},"4",-1)),s("div",cs,o(l.translations.additional),1)],2)])])]),s("form",{onSubmit:N(T,["prevent"]),class:"needs-validation",novalidate:""},[c(s("div",us,[s("h6",ms,[t[15]||(t[15]=s("i",{class:"bi bi-info-circle me-2"},null,-1)),v(" "+o(l.translations.basic_info),1)]),s("div",vs,[s("label",ps,o(l.translations.name),1),s("div",bs,[s("div",gs,[t[16]||(t[16]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-box-seam"})],-1)),c(s("input",{id:"inputName",type:"text",class:d(["form-control",{"is-invalid":i(e).errors.name}]),placeholder:l.translations.enter_product_name,"onUpdate:modelValue":t[0]||(t[0]=a=>i(e).name=a),required:"",onInput:I},null,42,_s),[[p,i(e).name]])]),s("div",fs,o(l.translations.product_name_help),1),b(g,{message:i(e).errors.name},null,8,["message"])])]),s("div",hs,[s("label",xs,o(l.translations.barcode),1),s("div",ys,[s("div",ws,[t[21]||(t[21]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-upc-scan"})],-1)),c(s("input",{id:"inputBarcode",type:"text",class:d(["form-control",{"is-invalid":r.value.checking===!1&&!r.value.isValid,"is-valid":i(e).barcode&&r.value.isValid}]),placeholder:l.translations.enter_barcode_or_auto_generate,"onUpdate:modelValue":t[1]||(t[1]=a=>i(e).barcode=a),onInput:t[2]||(t[2]=a=>i(U)(i(e).barcode))},null,42,ks),[[p,i(e).barcode]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:P,disabled:r.value.checking,title:l.translations.auto_generate_barcode},t[17]||(t[17]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1)]),8,Vs),r.value.checking?(u(),m("div",qs,t[18]||(t[18]=[s("span",{class:"spinner-border spinner-border-sm",role:"status"},null,-1)]))):r.value.isValid?i(e).barcode&&r.value.isValid?(u(),m("div",Bs,t[20]||(t[20]=[s("i",{class:"bi bi-check-circle"},null,-1)]))):h("",!0):(u(),m("div",Cs,t[19]||(t[19]=[s("i",{class:"bi bi-exclamation-triangle"},null,-1)])))]),r.value.message?(u(),m("div",{key:0,class:d(["form-text",r.value.isValid?"text-success":"text-danger"])},o(r.value.message),3)):h("",!0),s("div",Is,o(l.translations.barcode_help),1),b(g,{message:i(e).errors.barcode},null,8,["message"])])]),s("div",Us,[s("label",Ss,o(l.translations.model)+" ("+o(l.translations.optional)+")",1),s("div",Ns,[s("div",Fs,[t[22]||(t[22]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-tag"})],-1)),c(s("input",{id:"inputModel",type:"text",class:d(["form-control",{"is-invalid":i(e).errors.model}]),placeholder:l.translations.enter_model_number,"onUpdate:modelValue":t[3]||(t[3]=a=>i(e).model=a)},null,10,Ms),[[p,i(e).model]])]),s("div",Ps,o(l.translations.model_help),1),b(g,{message:i(e).errors.model},null,8,["message"])])]),s("div",js,[s("label",Es,o(l.translations.oe_number),1),s("div",$s,[s("div",Ds,[t[23]||(t[23]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-hash"})],-1)),c(s("input",{id:"inputOENumber",type:"text",class:d(["form-control",{"is-invalid":i(e).errors.oe_number}]),placeholder:l.translations.enter_oe_number,"onUpdate:modelValue":t[4]||(t[4]=a=>i(e).oe_number=a)},null,10,Ts),[[p,i(e).oe_number]])]),s("div",Os,o(l.translations.oe_number_help),1),b(g,{message:i(e).errors.oe_number},null,8,["message"])])])],512),[[q,n.value>=1]]),c(s("div",Qs,[s("h6",Rs,[t[24]||(t[24]=s("i",{class:"bi bi-currency-dollar me-2"},null,-1)),v(" "+o(l.translations.pricing),1)]),s("div",zs,[s("label",As,o(l.translations.price_cost),1),s("div",Gs,[s("div",Ls,[t[25]||(t[25]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-cart-plus"})],-1)),c(s("input",{id:"inputPriceCost",type:"number",step:"0.01",min:"0",class:d(["form-control",{"is-invalid":i(e).errors.price_cost}]),placeholder:l.translations.enter_cost_price,"onUpdate:modelValue":t[5]||(t[5]=a=>i(e).price_cost=a),onInput:S},null,42,Hs),[[p,i(e).price_cost]]),s("span",Js,o(l.translations.dinar),1)]),s("div",Ks,o(l.translations.cost_price_help),1),b(g,{message:i(e).errors.price_cost},null,8,["message"])])]),s("div",Ws,[s("label",Xs,o(l.translations.price),1),s("div",Ys,[s("div",Zs,[t[26]||(t[26]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-cash-stack"})],-1)),c(s("input",{id:"inputPrice",type:"number",step:"0.01",min:"0",class:d(["form-control",{"is-invalid":i(e).errors.price}]),placeholder:l.translations.enter_selling_price,"onUpdate:modelValue":t[6]||(t[6]=a=>i(e).price=a),required:"",onInput:S},null,42,st),[[p,i(e).price]]),s("span",tt,o(l.translations.dinar),1)]),s("div",et,o(l.translations.selling_price_help),1),b(g,{message:i(e).errors.price},null,8,["message"])])]),k.value!==null?(u(),m("div",lt,[t[28]||(t[28]=s("div",{class:"col-sm-2"},null,-1)),s("div",ot,[s("div",it,[t[27]||(t[27]=s("i",{class:"bi bi-graph-up me-2"},null,-1)),s("strong",null,o(l.translations.profit_margin)+":",1),v(" "+o(k.value.toFixed(2))+" "+o(l.translations.dinar)+" ("+o(C.value.toFixed(1))+"%) ",1)])])])):h("",!0)],512),[[q,n.value>=2]]),c(s("div",at,[s("h6",nt,[t[29]||(t[29]=s("i",{class:"bi bi-boxes me-2"},null,-1)),v(" "+o(l.translations.inventory),1)]),s("div",rt,[s("label",dt,o(l.translations.quantity),1),s("div",ct,[s("div",ut,[t[30]||(t[30]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-123"})],-1)),c(s("input",{id:"inputQuantity",type:"number",min:"0",class:d(["form-control",{"is-invalid":i(e).errors.quantity}]),placeholder:l.translations.enter_initial_quantity,"onUpdate:modelValue":t[7]||(t[7]=a=>i(e).quantity=a),required:""},null,10,mt),[[p,i(e).quantity]]),s("span",vt,o(l.translations.units),1)]),s("div",pt,o(l.translations.quantity_help),1),b(g,{message:i(e).errors.quantity},null,8,["message"])])])],512),[[q,n.value>=3]]),c(s("div",bt,[s("h6",gt,[t[31]||(t[31]=s("i",{class:"bi bi-info-square me-2"},null,-1)),v(" "+o(l.translations.additional),1)]),s("div",_t,[s("label",ft,o(l.translations.note),1),s("div",ht,[s("div",xt,[t[32]||(t[32]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-journal-text"})],-1)),c(s("textarea",{id:"inputNote",class:d(["form-control",{"is-invalid":i(e).errors.notes}]),placeholder:l.translations.enter_notes_optional,"onUpdate:modelValue":t[8]||(t[8]=a=>i(e).notes=a),rows:"3"},null,10,yt),[[p,i(e).notes]])]),s("div",wt,o(l.translations.notes_help),1),b(g,{message:i(e).errors.notes},null,8,["message"])])]),s("div",kt,[s("label",Vt,o(l.translations.date),1),s("div",qt,[s("div",Ct,[t[33]||(t[33]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-calendar"})],-1)),c(s("input",{id:"inputdate",type:"date",class:d(["form-control",{"is-invalid":i(e).errors.date}]),"onUpdate:modelValue":t[9]||(t[9]=a=>i(e).date=a)},null,2),[[p,i(e).date]])]),s("div",Bt,o(l.translations.date_help),1),b(g,{message:i(e).errors.date},null,8,["message"])])]),s("div",It,[s("label",Ut,o(l.translations.image),1),s("div",St,[s("div",{class:d(["image-upload-area",{"has-image":w.value}]),onClick:E},[s("input",{ref_key:"fileInput",ref:V,id:"inputImage",type:"file",accept:"image/*",onInput:$,style:{display:"none"}},null,544),w.value?(u(),m("div",Mt,[s("img",{src:w.value,alt:l.translations.product_image},null,8,Pt),s("button",{type:"button",class:"btn btn-sm btn-danger remove-image",onClick:N(D,["stop"])},t[35]||(t[35]=[s("i",{class:"bi bi-x"},null,-1)]))])):(u(),m("div",Nt,[t[34]||(t[34]=s("i",{class:"bi bi-cloud-upload"},null,-1)),s("p",null,o(l.translations.click_to_upload_image),1),s("small",Ft,o(l.translations.supported_formats),1)]))],2),i(e).progress?(u(),m("progress",{key:0,value:i(e).progress.percentage,max:"100",class:"w-100 mt-2"},o(i(e).progress.percentage)+"% ",9,jt)):h("",!0),s("div",Et,o(l.translations.image_help),1)])])],512),[[q,n.value>=4]]),s("div",$t,[s("div",Dt,[s("div",Tt,[s("button",{type:"button",class:"btn btn-outline-secondary",onClick:M,disabled:n.value===1},[t[36]||(t[36]=s("i",{class:"bi bi-arrow-left me-2"},null,-1)),v(" "+o(l.translations.previous),1)],8,Ot),s("div",null,[n.value<4?(u(),m("button",{key:0,type:"button",class:"btn btn-primary me-2",onClick:F},[v(o(l.translations.next)+" ",1),t[37]||(t[37]=s("i",{class:"bi bi-arrow-right ms-2"},null,-1))])):h("",!0),s("button",{type:"submit",class:"btn btn-success",disabled:x.value||!B.value},[x.value?h("",!0):(u(),m("i",Rt)),x.value?(u(),m("span",zt)):h("",!0),v(" "+o(l.translations.save),1)],8,Qt)])])])])],32)])])])])])]),_:1},8,["translations"]))}},Wt=K(At,[["__scopeId","data-v-377b8f9b"]]);export{Wt as default};
