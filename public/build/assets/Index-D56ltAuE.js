import{Q as Y,r as p,k as z,o as G,a as n,h as P,w as $,b as t,c as i,d as m,e as v,n as g,l as b,x as E,A as x,F as _,f as y,t as e,D as q}from"./app-Gc0s28HQ.js";import{A as H}from"./AuthenticatedLayout-DcTpRD1p.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"d-flex justify-content-between align-items-center"},W={class:"py-12"},X={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Z={class:"card mb-4"},tt={class:"card-header"},st={class:"nav nav-tabs card-header-tabs",role:"tablist"},lt={class:"nav-item",role:"presentation"},et={class:"nav-item",role:"presentation"},at={class:"nav-item",role:"presentation"},ot={class:"nav-item",role:"presentation"},nt={class:"card mb-4"},it={class:"card-body"},dt={class:"row g-3"},ut={class:"col-md-3"},rt={class:"col-md-3"},ct={key:0,class:"col-md-3"},vt=["value"],pt={key:1,class:"col-md-3"},mt=["value"],bt={key:2,class:"col-md-3"},_t=["value"],yt={key:3,class:"col-md-3"},gt=["value"],ht={key:4,class:"col-md-3"},ft={key:0,class:"text-center py-5"},xt={key:1,class:"card"},kt={class:"card-body"},wt={key:0},Dt={class:"row mb-4"},Ct={class:"col-md-3"},St={class:"card bg-primary text-white"},Ut={class:"card-body"},Tt={class:"col-md-3"},Vt={class:"card bg-success text-white"},Ft={class:"card-body"},It={class:"col-md-3"},Nt={class:"card bg-warning text-white"},At={class:"card-body"},Bt={class:"col-md-3"},Lt={class:"card bg-info text-white"},Mt={class:"card-body"},Ot={class:"table-responsive"},$t={class:"table table-striped"},Et={key:1},Qt={class:"row mb-4"},Rt={class:"col-md-4"},jt={class:"card bg-primary text-white"},Yt={class:"card-body"},zt={class:"col-md-4"},Gt={class:"card bg-info text-white"},Pt={class:"card-body"},qt={class:"col-md-4"},Ht={class:"card bg-secondary text-white"},Jt={class:"card-body"},Kt={class:"table-responsive"},Wt={class:"table table-striped"},Xt={key:2},Zt={class:"row mb-4"},ts={class:"col-md-4"},ss={class:"card bg-danger text-white"},ls={class:"card-body"},es={class:"col-md-4"},as={class:"card bg-info text-white"},os={class:"card-body"},ns={class:"col-md-4"},is={class:"card bg-secondary text-white"},ds={class:"card-body"},us={class:"table-responsive"},rs={class:"table table-striped"},cs={key:3},vs={class:"row mb-4"},ps={class:"col-md-3"},ms={class:"card bg-success text-white"},bs={class:"card-body"},_s={class:"col-md-3"},ys={class:"card bg-primary text-white"},gs={class:"card-body"},hs={class:"col-md-3"},fs={class:"card bg-danger text-white"},xs={class:"card-body"},ks={class:"col-md-3"},ws={class:"card-body text-white"},Ds={key:2,class:"card"},Cs={__name:"Index",props:{activeTab:{type:String,default:"sales"},translations:Object},setup(Q){Y();const S=Q,d=p(S.activeTab),D=p(!1),a=p(null),U=p([]),T=p([]),V=p([]),F=p([]),o=p({start_date:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0],customer_id:"",product_id:"",supplier_id:"",category:"",currency:""}),R=z(()=>S.translations||{}),k=u=>{d.value=u,a.value=null,I(),c()},I=()=>{o.value={start_date:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0],customer_id:"",product_id:"",supplier_id:"",category:"",currency:""}},c=async()=>{D.value=!0;try{let u="";const s={start_date:o.value.start_date,end_date:o.value.end_date};switch(d.value){case"sales":u=route("reports.sales"),o.value.customer_id&&(s.customer_id=o.value.customer_id),o.value.product_id&&(s.product_id=o.value.product_id);break;case"purchases":u=route("reports.purchases"),o.value.supplier_id&&(s.supplier_id=o.value.supplier_id);break;case"expenses":u=route("reports.expenses"),o.value.category&&(s.category=o.value.category),o.value.currency&&(s.currency=o.value.currency);break;case"summary":u=route("reports.summary");break}const w=await q.get(u,{params:s});a.value=w.data,d.value==="sales"&&a.value.customers&&(U.value=a.value.customers,T.value=a.value.products||[]),d.value==="purchases"&&a.value.suppliers&&(V.value=a.value.suppliers),d.value==="expenses"&&a.value.categories&&(F.value=a.value.categories)}catch(u){console.error("Error loading report:",u)}finally{D.value=!1}},N=()=>{const u=new URLSearchParams({...o.value,format:"print"});let s="";switch(d.value){case"sales":s="reports.sales.print";break;case"purchases":s="reports.purchases.print";break;case"expenses":s="reports.expenses.print";break;case"summary":s="reports.summary.print";break}s&&window.open(route(s)+"?"+u.toString(),"_blank")},r=u=>parseFloat(u||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}).replace(/\.00$/,""),C=u=>u?new Date(u).toLocaleDateString("ar-EG"):"N/A",j=u=>({paid:"badge bg-success",unpaid:"badge bg-danger",partial:"badge bg-warning"})[u]||"badge bg-secondary";return G(()=>{c()}),(u,s)=>(n(),P(H,{translations:R.value},{header:$(()=>[t("div",K,[s[12]||(s[12]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," التقارير ",-1)),a.value?(n(),i("button",{key:0,class:"btn btn-primary",onClick:N},s[11]||(s[11]=[t("i",{class:"bi bi-printer"},null,-1),m(" طباعة التقرير ")]))):v("",!0)])]),default:$(()=>{var w,A,B,L,M,O;return[t("div",W,[t("div",X,[t("div",Z,[t("div",tt,[t("ul",st,[t("li",lt,[t("button",{class:g(["nav-link",{active:d.value==="sales"}]),onClick:s[0]||(s[0]=l=>k("sales")),type:"button"},s[13]||(s[13]=[t("i",{class:"bi bi-cart-check"},null,-1),m(" تقرير المبيعات ")]),2)]),t("li",et,[t("button",{class:g(["nav-link",{active:d.value==="purchases"}]),onClick:s[1]||(s[1]=l=>k("purchases")),type:"button"},s[14]||(s[14]=[t("i",{class:"bi bi-box-arrow-in-down"},null,-1),m(" تقرير المشتريات ")]),2)]),t("li",at,[t("button",{class:g(["nav-link",{active:d.value==="expenses"}]),onClick:s[2]||(s[2]=l=>k("expenses")),type:"button"},s[15]||(s[15]=[t("i",{class:"bi bi-cash-stack"},null,-1),m(" تقرير المصاريف ")]),2)]),t("li",ot,[t("button",{class:g(["nav-link",{active:d.value==="summary"}]),onClick:s[3]||(s[3]=l=>k("summary")),type:"button"},s[16]||(s[16]=[t("i",{class:"bi bi-graph-up"},null,-1),m(" التقرير الشامل ")]),2)])])])]),t("div",nt,[t("div",it,[t("div",dt,[t("div",ut,[s[17]||(s[17]=t("label",{class:"form-label"},"من تاريخ",-1)),b(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=l=>o.value.start_date=l),onChange:c},null,544),[[E,o.value.start_date]])]),t("div",rt,[s[18]||(s[18]=t("label",{class:"form-label"},"إلى تاريخ",-1)),b(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=l=>o.value.end_date=l),onChange:c},null,544),[[E,o.value.end_date]])]),d.value==="sales"?(n(),i("div",ct,[s[20]||(s[20]=t("label",{class:"form-label"},"العميل",-1)),b(t("select",{class:"form-select","onUpdate:modelValue":s[6]||(s[6]=l=>o.value.customer_id=l),onChange:c},[s[19]||(s[19]=t("option",{value:""},"الكل",-1)),(n(!0),i(_,null,y(U.value,l=>(n(),i("option",{key:l.id,value:l.id},e(l.name),9,vt))),128))],544),[[x,o.value.customer_id]])])):v("",!0),d.value==="sales"?(n(),i("div",pt,[s[22]||(s[22]=t("label",{class:"form-label"},"المنتج",-1)),b(t("select",{class:"form-select","onUpdate:modelValue":s[7]||(s[7]=l=>o.value.product_id=l),onChange:c},[s[21]||(s[21]=t("option",{value:""},"الكل",-1)),(n(!0),i(_,null,y(T.value,l=>(n(),i("option",{key:l.id,value:l.id},e(l.name),9,mt))),128))],544),[[x,o.value.product_id]])])):v("",!0),d.value==="purchases"?(n(),i("div",bt,[s[24]||(s[24]=t("label",{class:"form-label"},"المورد",-1)),b(t("select",{class:"form-select","onUpdate:modelValue":s[8]||(s[8]=l=>o.value.supplier_id=l),onChange:c},[s[23]||(s[23]=t("option",{value:""},"الكل",-1)),(n(!0),i(_,null,y(V.value,l=>(n(),i("option",{key:l.id,value:l.id},e(l.name),9,_t))),128))],544),[[x,o.value.supplier_id]])])):v("",!0),d.value==="expenses"?(n(),i("div",yt,[s[26]||(s[26]=t("label",{class:"form-label"},"الفئة",-1)),b(t("select",{class:"form-select","onUpdate:modelValue":s[9]||(s[9]=l=>o.value.category=l),onChange:c},[s[25]||(s[25]=t("option",{value:""},"الكل",-1)),(n(!0),i(_,null,y(F.value,l=>(n(),i("option",{key:l,value:l},e(l),9,gt))),128))],544),[[x,o.value.category]])])):v("",!0),d.value==="expenses"?(n(),i("div",ht,[s[28]||(s[28]=t("label",{class:"form-label"},"العملة",-1)),b(t("select",{class:"form-select","onUpdate:modelValue":s[10]||(s[10]=l=>o.value.currency=l),onChange:c},s[27]||(s[27]=[t("option",{value:""},"الكل",-1),t("option",{value:"IQD"},"IQD",-1),t("option",{value:"USD"},"USD",-1)]),544),[[x,o.value.currency]])])):v("",!0),t("div",{class:"col-md-12"},[t("button",{class:"btn btn-primary",onClick:c},s[29]||(s[29]=[t("i",{class:"bi bi-search"},null,-1),m(" تطبيق الفلتر ")])),t("button",{class:"btn btn-secondary ms-2",onClick:I},s[30]||(s[30]=[t("i",{class:"bi bi-arrow-counterclockwise"},null,-1),m(" إعادة تعيين ")]))])])])]),D.value?(n(),i("div",ft,s[31]||(s[31]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"جاري التحميل...")],-1)]))):a.value?(n(),i("div",xt,[t("div",kt,[t("div",{class:"mb-4 text-end"},[t("button",{class:"btn btn-primary btn-lg",onClick:N},s[32]||(s[32]=[t("i",{class:"bi bi-printer"},null,-1),m(" طباعة التقرير ")]))]),d.value==="sales"&&a.value.statistics?(n(),i("div",wt,[s[38]||(s[38]=t("h4",{class:"mb-4"},"إحصائيات المبيعات",-1)),t("div",Dt,[t("div",Ct,[t("div",St,[t("div",Ut,[s[33]||(s[33]=t("h6",null,"إجمالي المبيعات",-1)),t("h3",null,e(r(a.value.statistics.total_amount)),1)])])]),t("div",Tt,[t("div",Vt,[t("div",Ft,[s[34]||(s[34]=t("h6",null,"المدفوع",-1)),t("h3",null,e(r(a.value.statistics.total_paid)),1)])])]),t("div",It,[t("div",Nt,[t("div",At,[s[35]||(s[35]=t("h6",null,"المتبقي",-1)),t("h3",null,e(r(a.value.statistics.remaining)),1)])])]),t("div",Bt,[t("div",Lt,[t("div",Mt,[s[36]||(s[36]=t("h6",null,"عدد الفواتير",-1)),t("h3",null,e(a.value.statistics.total_count),1)])])])]),s[39]||(s[39]=t("h5",{class:"mb-3"},"الفواتير",-1)),t("div",Ot,[t("table",$t,[s[37]||(s[37]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"التاريخ"),t("th",null,"العميل"),t("th",null,"المبلغ"),t("th",null,"المدفوع"),t("th",null,"الحالة")])],-1)),t("tbody",null,[(n(!0),i(_,null,y(a.value.orders,(l,h)=>{var f;return n(),i("tr",{key:l.id},[t("td",null,e(h+1),1),t("td",null,e(C(l.date)),1),t("td",null,e(((f=l.customer)==null?void 0:f.name)||"N/A"),1),t("td",null,e(r(l.final_amount||l.total_amount)),1),t("td",null,e(r(l.total_paid)),1),t("td",null,[t("span",{class:g(j(l.status))},e(l.status),3)])])}),128))])])])])):v("",!0),d.value==="purchases"&&a.value.statistics?(n(),i("div",Et,[s[44]||(s[44]=t("h4",{class:"mb-4"},"إحصائيات المشتريات",-1)),t("div",Qt,[t("div",Rt,[t("div",jt,[t("div",Yt,[s[40]||(s[40]=t("h6",null,"إجمالي المشتريات",-1)),t("h3",null,e(r(a.value.statistics.total_amount)),1)])])]),t("div",zt,[t("div",Gt,[t("div",Pt,[s[41]||(s[41]=t("h6",null,"عدد الفواتير",-1)),t("h3",null,e(a.value.statistics.total_count),1)])])]),t("div",qt,[t("div",Ht,[t("div",Jt,[s[42]||(s[42]=t("h6",null,"متوسط الفاتورة",-1)),t("h3",null,e(r(a.value.statistics.average_purchase)),1)])])])]),s[45]||(s[45]=t("h5",{class:"mb-3"},"فواتير المشتريات",-1)),t("div",Kt,[t("table",Wt,[s[43]||(s[43]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"التاريخ"),t("th",null,"المورد"),t("th",null,"المبلغ")])],-1)),t("tbody",null,[(n(!0),i(_,null,y(a.value.purchases,(l,h)=>{var f;return n(),i("tr",{key:l.id},[t("td",null,e(h+1),1),t("td",null,e(C(l.invoice_date)),1),t("td",null,e(((f=l.supplier)==null?void 0:f.name)||"N/A"),1),t("td",null,e(r(l.total_amount)),1)])}),128))])])])])):v("",!0),d.value==="expenses"&&a.value.statistics?(n(),i("div",Xt,[s[50]||(s[50]=t("h4",{class:"mb-4"},"إحصائيات المصاريف",-1)),t("div",Zt,[t("div",ts,[t("div",ss,[t("div",ls,[s[46]||(s[46]=t("h6",null,"إجمالي المصاريف",-1)),t("h3",null,e(r(a.value.statistics.total_amount)),1)])])]),t("div",es,[t("div",as,[t("div",os,[s[47]||(s[47]=t("h6",null,"عدد السجلات",-1)),t("h3",null,e(a.value.statistics.total_count),1)])])]),t("div",ns,[t("div",is,[t("div",ds,[s[48]||(s[48]=t("h6",null,"متوسط المصروف",-1)),t("h3",null,e(r(a.value.statistics.average_expense)),1)])])])]),s[51]||(s[51]=t("h5",{class:"mb-3"},"المصاريف",-1)),t("div",us,[t("table",rs,[s[49]||(s[49]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"التاريخ"),t("th",null,"الوصف"),t("th",null,"الفئة"),t("th",null,"المبلغ"),t("th",null,"العملة")])],-1)),t("tbody",null,[(n(!0),i(_,null,y(a.value.expenses,(l,h)=>(n(),i("tr",{key:l.id},[t("td",null,e(h+1),1),t("td",null,e(C(l.expense_date)),1),t("td",null,e(l.title),1),t("td",null,e(l.category||"غير محدد"),1),t("td",null,e(r(l.amount)),1),t("td",null,e(l.currency),1)]))),128))])])])])):v("",!0),d.value==="summary"&&a.value?(n(),i("div",cs,[s[56]||(s[56]=t("h4",{class:"mb-4"},"التقرير الشامل",-1)),t("div",vs,[t("div",ps,[t("div",ms,[t("div",bs,[s[52]||(s[52]=t("h6",null,"إجمالي المبيعات",-1)),t("h3",null,e(r(((w=a.value.sales)==null?void 0:w.total)||0)),1),t("small",null,e(((A=a.value.sales)==null?void 0:A.count)||0)+" فاتورة",1)])])]),t("div",_s,[t("div",ys,[t("div",gs,[s[53]||(s[53]=t("h6",null,"إجمالي المشتريات",-1)),t("h3",null,e(r(((B=a.value.purchases)==null?void 0:B.total)||0)),1),t("small",null,e(((L=a.value.purchases)==null?void 0:L.count)||0)+" فاتورة",1)])])]),t("div",hs,[t("div",fs,[t("div",xs,[s[54]||(s[54]=t("h6",null,"إجمالي المصاريف",-1)),t("h3",null,e(r(((M=a.value.expenses)==null?void 0:M.total)||0)),1),t("small",null,e(((O=a.value.expenses)==null?void 0:O.count)||0)+" سجل",1)])])]),t("div",ks,[t("div",{class:g(["card",a.value.profit>=0?"bg-info text-white":"bg-warning text-white"])},[t("div",ws,[s[55]||(s[55]=t("h6",null,"الربح الإجمالي",-1)),t("h3",null,e(r(a.value.profit||0)),1),t("small",null,e((a.value.profit_percentage||0).toFixed(2))+"%",1)])],2)])])])):v("",!0)])])):(n(),i("div",Ds,s[57]||(s[57]=[t("div",{class:"card-body text-center py-5"},[t("p",{class:"text-muted"},"لا توجد بيانات لعرضها")],-1)])))])])]}),_:1},8,["translations"]))}},Vs=J(Cs,[["__scopeId","data-v-9285a90b"]]);export{Vs as default};
