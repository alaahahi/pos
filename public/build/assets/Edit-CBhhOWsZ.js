import{r as k,s as U,T as C,C as E,a as d,c as O,w,b as e,t as n,i as c,d as x,j,l as u,y as m,u as t,n as V,e as b,f}from"./app-Dyo3CGUB.js";import{_ as P}from"./AuthenticatedLayout-DQQOHWHW.js";import{_ as p}from"./InputError-BKaRmLoe.js";import{l as T}from"./lodash-BWRDsr-N.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"pagetitle dark:text-white"},S={class:"dark:text-white"},R={class:"breadcrumb"},$={class:"breadcrumb-item"},A={class:"breadcrumb-item active dark:text-white"},D={class:"breadcrumb-item active dark:text-white"},I={class:"section dashboard"},L={class:"row"},Q={class:"col-lg-12"},z={class:"card"},H={class:"card-body"},F={class:"card-title"},G={class:"row mb-3"},J={for:"inputName",class:"col-sm-2 col-form-label"},K={class:"col-sm-10"},W=["placeholder"],X={class:"row mb-3"},Y={for:"inputBarcode",class:"col-sm-2 col-form-label"},Z={class:"col-sm-10"},ee={class:"input-group"},se=["placeholder"],te={key:0,class:"input-group-text"},oe={key:1,class:"input-group-text text-danger"},ae={key:2,class:"input-group-text text-success"},le={class:"row mb-3"},ne={for:"inputModel",class:"col-sm-2 col-form-label"},ie={class:"col-sm-10"},re=["placeholder"],ce={class:"row mb-3"},de={for:"inputOENumber",class:"col-sm-2 col-form-label"},ue={class:"col-sm-10"},me=["placeholder"],pe={class:"row mb-3"},be={for:"inputPrice",class:"col-sm-2 col-form-label"},he={class:"col-sm-10"},_e=["placeholder"],ve={class:"row mb-3"},fe={for:"inputPrice",class:"col-sm-2 col-form-label"},ge={class:"col-sm-10"},ye=["placeholder"],ke={class:"row mb-3"},we={for:"inputQuantity",class:"col-sm-2 col-form-label"},xe={class:"col-sm-10"},Ve=["placeholder"],Ne={class:"row mb-3"},qe={for:"inputNote",class:"col-sm-2 col-form-label"},Be={class:"col-sm-10"},Ue=["placeholder"],Ce={class:"row mb-3"},Ee={for:"inputdate",class:"col-sm-2 col-form-label"},Oe={class:"col-sm-10"},je=["placeholder"],Pe={class:"row mb-3"},Te={for:"inputNumber",class:"col-sm-2 col-form-label"},Me={class:"col-sm-10"},Se=["src"],Re=["value"],$e={class:"text-center"},Ae=["disabled"],De={key:0,class:"bi bi-save"},Ie={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Ge={__name:"Edit",props:{product:Object,userRoles:Array,roles:Object,translations:Object},setup(a){const i=a,h=k(!1),g=U(),r=k({checking:!1,isValid:!0,message:""}),s=C({name:i.product.name,model:i.product.model,name:i.product.name,notes:i.product.notes,oe_number:i.product.oe_number,price_cost:i.product.price_cost,quantity:i.product.quantity,price:i.product.price,created:i.product.created,barcode:i.product.barcode,selectedRoles:i.userRoles}),N=async _=>{if(!_||_.length<3){r.value={checking:!1,isValid:!0,message:""};return}if(_===i.product.barcode){r.value={checking:!1,isValid:!0,message:""};return}r.value.checking=!0;try{const v=await(await fetch(route("products.checkBarcodeUnique",_))).json();r.value={checking:!1,isValid:v.unique,message:v.message},v.unique||g.warning(v.message)}catch(o){console.error("Barcode validation error:",o),r.value={checking:!1,isValid:!1,message:"خطأ في التحقق من الباركود"}}},q=T.debounce(N,500),B=()=>{if(s.barcode&&!r.value.isValid){g.error("يجب إدخال باركود صحيح ومتاح");return}h.value=!0,s.post(route("products.update",{product:i.product.id}),{onSuccess:()=>{h.value=!1},onError:()=>{h.value=!1}})};return(_,o)=>{const v=E("Link");return d(),O(P,{translations:a.translations},{default:w(()=>{var y;return[e("div",M,[e("h1",S,n(a.translations.users),1),e("nav",null,[e("ol",R,[e("li",$,[c(v,{class:"nav-link dark:text-white",href:_.route("dashboard")},{default:w(()=>[x(n(a.translations.Home),1)]),_:1},8,["href"])]),e("li",A,n(a.translations.users),1),e("li",D,n(a.translations.edit),1)])])]),e("section",I,[e("div",L,[e("div",Q,[e("div",z,[e("div",H,[e("h5",F,n(a.translations.edit_user_info),1),e("form",{onSubmit:j(B,["prevent"]),class:"row g-3",method:"POST"},[e("div",G,[e("label",J,n(a.translations.name),1),e("div",K,[u(e("input",{id:"inputName",type:"text",class:"form-control",placeholder:a.translations.name,"onUpdate:modelValue":o[0]||(o[0]=l=>t(s).name=l)},null,8,W),[[m,t(s).name]]),c(p,{message:t(s).errors.name},null,8,["message"])])]),e("div",X,[e("label",Y,n(a.translations.barcode),1),e("div",Z,[e("div",ee,[u(e("input",{id:"inputBarcode",type:"text",class:V(["form-control",{"is-invalid":r.value.checking===!1&&!r.value.isValid}]),placeholder:a.translations.barcode,"onUpdate:modelValue":o[1]||(o[1]=l=>t(s).barcode=l),onInput:o[2]||(o[2]=l=>t(q)(t(s).barcode))},null,42,se),[[m,t(s).barcode]]),r.value.checking?(d(),b("div",te,o[11]||(o[11]=[e("span",{class:"spinner-border spinner-border-sm",role:"status"},null,-1)]))):r.value.isValid?t(s).barcode&&r.value.isValid?(d(),b("div",ae,o[13]||(o[13]=[e("i",{class:"bi bi-check-circle"},null,-1)]))):f("",!0):(d(),b("div",oe,o[12]||(o[12]=[e("i",{class:"bi bi-exclamation-triangle"},null,-1)])))]),r.value.message?(d(),b("div",{key:0,class:V(["form-text",r.value.isValid?"text-success":"text-danger"])},n(r.value.message),3)):f("",!0),c(p,{message:t(s).errors.barcode},null,8,["message"])])]),e("div",le,[e("label",ne,n(a.translations.model),1),e("div",ie,[u(e("input",{id:"inputModel",type:"text",class:"form-control",placeholder:a.translations.model,"onUpdate:modelValue":o[3]||(o[3]=l=>t(s).model=l)},null,8,re),[[m,t(s).model]]),c(p,{message:t(s).errors.model},null,8,["message"])])]),e("div",ce,[e("label",de,n(a.translations.oe_number),1),e("div",ue,[u(e("input",{id:"inputOENumber",type:"text",class:"form-control",placeholder:a.translations.oe_number,"onUpdate:modelValue":o[4]||(o[4]=l=>t(s).oe_number=l)},null,8,me),[[m,t(s).oe_number]]),c(p,{message:t(s).errors.oe_number},null,8,["message"])])]),e("div",pe,[e("label",be,n(a.translations.price_cost),1),e("div",he,[u(e("input",{id:"inputPrice",type:"number",class:"form-control",placeholder:a.translations.price_cost,"onUpdate:modelValue":o[5]||(o[5]=l=>t(s).price_cost=l)},null,8,_e),[[m,t(s).price_cost]]),c(p,{message:t(s).errors.price_cost},null,8,["message"])])]),e("div",ve,[e("label",fe,n(a.translations.price),1),e("div",ge,[u(e("input",{id:"inputPrice",type:"number",class:"form-control",placeholder:a.translations.price,"onUpdate:modelValue":o[6]||(o[6]=l=>t(s).price=l)},null,8,ye),[[m,t(s).price]]),c(p,{message:t(s).errors.price},null,8,["message"])])]),e("div",ke,[e("label",we,n(a.translations.quantity),1),e("div",xe,[u(e("input",{id:"inputQuantity",type:"number",class:"form-control",placeholder:a.translations.quantity,"onUpdate:modelValue":o[7]||(o[7]=l=>t(s).quantity=l)},null,8,Ve),[[m,t(s).quantity]]),c(p,{message:t(s).errors.quantity},null,8,["message"])])]),e("div",Ne,[e("label",qe,n(a.translations.note),1),e("div",Be,[u(e("input",{id:"inputNote",type:"text",class:"form-control",placeholder:a.translations.note,"onUpdate:modelValue":o[8]||(o[8]=l=>t(s).notes=l)},null,8,Ue),[[m,t(s).notes]]),c(p,{message:t(s).errors.notes},null,8,["message"])])]),e("div",Ce,[e("label",Ee,n(a.translations.date),1),e("div",Oe,[u(e("input",{id:"inputdate",type:"date",class:"form-control",placeholder:a.translations.date,"onUpdate:modelValue":o[9]||(o[9]=l=>t(s).created=l)},null,8,je),[[m,t(s).created]]),c(p,{message:t(s).errors.created},null,8,["message"])])]),e("div",Pe,[e("label",Te,n(a.translations.image),1),e("div",Me,[e("input",{type:"file",onInput:o[10]||(o[10]=l=>t(s).image=l.target.files[0])},null,32),(y=i.user)!=null&&y.image?(d(),b("img",{key:0,src:i.user.image,alt:"Current Avatar",class:"img-thumbnail",width:"80"},null,8,Se)):f("",!0),t(s).progress?(d(),b("progress",{key:1,value:t(s).progress.percentage,max:"100"},n(t(s).progress.percentage)+"% ",9,Re)):f("",!0)])]),e("div",$e,[e("button",{type:"submit",class:"btn btn-primary",disabled:h.value},[x(n(a.translations.update)+"   ",1),h.value?f("",!0):(d(),b("i",De)),h.value?(d(),b("span",Ie)):f("",!0)],8,Ae)])],32)])])])])])]}),_:1},8,["translations"])}}};export{Ge as default};
