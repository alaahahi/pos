import{r as k,z as B,a as d,h as L,w as S,b as t,t as s,i as $,d as r,u as j,p as N,j as P,l as v,x as A,A as C,c as u,f as V,e as c,n as _,F as O,g as M}from"./app-CsmwpidE.js";import{_ as R}from"./AuthenticatedLayout-Dgx0EGdx.js";import{_ as W}from"./Pagination-_XhftZJ9.js";import{P as X}from"./PricingEditModal-C9f_2CbV.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"d-flex justify-content-between align-items-center"},tt={class:"font-semibold text-xl text-gray-800 leading-tight"},st={class:"py-12"},et={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},at={class:"card mb-4"},nt={class:"card-body"},lt={class:"row"},ot={class:"col-md-4"},it=["placeholder"],dt={class:"col-md-4"},ut={value:""},ct={value:"created"},rt={value:"received"},mt={value:"executing"},vt={value:"partial_payment"},_t={value:"full_payment"},bt={value:"completed"},yt={value:"cancelled"},ht={class:"col-md-4"},ft={type:"submit",class:"btn btn-primary w-100"},gt={class:"card"},pt={class:"card-body"},xt={class:"table-responsive"},kt={class:"table table-striped"},wt={class:"text-muted"},St={class:"text-muted"},At={class:"text-muted"},$t={class:"pricing-details"},jt={class:"d-flex justify-content-between mb-1"},Ct={key:0,class:"d-flex justify-content-between mb-1"},Vt={class:"text-success"},Ot={class:"text-success"},Mt={key:1,class:"d-flex justify-content-between mb-1"},Ut={class:"text-danger"},Dt={class:"text-danger"},Ft={class:"d-flex justify-content-between"},Et={class:"text-primary"},It={class:"d-flex justify-content-between mt-1"},Bt={class:"text-success"},Lt={key:0},Nt={key:1,class:"text-muted"},Pt={class:"btn-group",role:"group"},Tt=["onClick"],zt=["onClick"],Gt=["href"],qt={key:0,class:"d-flex justify-content-center mt-4"},Ht={key:1,class:"text-center py-5"},Jt={class:"text-muted mt-3"},Kt={class:"text-muted"},Qt={key:0,class:"modal-mask"},Rt={class:"modal-wrapper"},Wt={class:"modal-container"},Xt={class:"modal-header"},Yt={class:"modal-body"},Zt={key:0,class:"alert alert-danger mb-3",role:"alert"},ts={class:"mb-0"},ss={class:"row"},es={class:"col-md-6"},as={class:"mb-3"},ns={class:"form-label"},ls={value:""},os={value:"created"},is={value:"received"},ds={value:"executing"},us={value:"partial_payment"},cs={value:"full_payment"},rs={value:"completed"},ms={value:"cancelled"},vs={key:0,class:"invalid-feedback"},_s={class:"col-md-6"},bs={class:"mb-3"},ys={class:"form-label"},hs={value:""},fs=["value"],gs={key:0,class:"invalid-feedback"},ps={key:0,class:"col-md-6"},xs={class:"mb-3"},ks={class:"form-label"},ws={key:0,class:"invalid-feedback"},Ss={class:"col-md-6"},As={class:"mb-3"},$s={class:"form-label"},js={key:0,class:"invalid-feedback"},Cs={class:"col-12"},Vs={class:"mb-3"},Os={class:"form-label"},Ms={key:0,class:"invalid-feedback"},Us={class:"d-flex justify-content-center gap-2"},Ds=["disabled"],Fs={key:0,class:"spinner-border spinner-border-sm me-2"},Es={__name:"Orders",props:{orders:Object,filters:Object,translations:Object,employees:Array},setup(n){var U,D;const m=n,b=k(!1),w=k(!1),y=k(!1),h=k(null),l=k({}),f=B({search:((U=m.filters)==null?void 0:U.search)||"",status:((D=m.filters)==null?void 0:D.status)||""}),o=B({status:"",assigned_employee_id:"",paid_amount:"",scheduled_date:"",notes:""}),T=()=>{M.get(route("decorations.orders"),f,{preserveState:!0,replace:!0})},z=i=>{h.value=i,o.status=i.status||"",o.assigned_employee_id=i.assigned_employee_id||"",o.paid_amount=i.paid_amount||"",o.scheduled_date=i.scheduled_date?J(i.scheduled_date):"",o.notes=i.notes||"",l.value={},b.value=!0},G=i=>{h.value=i,w.value=!0},g=i=>i==="dollar"?"دولار":"دينار",q=()=>{y.value=!0,l.value={};const i={};o.status&&o.status!==""&&(i.status=o.status),o.assigned_employee_id&&o.assigned_employee_id!==""&&(i.assigned_employee_id=o.assigned_employee_id),o.paid_amount&&o.paid_amount!==""&&(i.paid_amount=o.paid_amount),o.scheduled_date&&o.scheduled_date!==""&&(i.scheduled_date=o.scheduled_date),o.notes&&o.notes!==""&&(i.notes=o.notes),M.patch(route("decoration.orders.status",h.value.id),i,{onSuccess:()=>{y.value=!1,b.value=!1,l.value={}},onError:e=>{y.value=!1,l.value=e,console.error("Update status errors:",e)}})},H=i=>new Date(i).toLocaleDateString("ar-EG"),J=i=>new Date(i).toISOString().slice(0,16),p=i=>{l.value[i]&&delete l.value[i]},K=i=>({status:m.translations.status||"الحالة",assigned_employee_id:m.translations.assign_employee||"تعيين موظف",paid_amount:m.translations.paid_amount||"المبلغ المدفوع",scheduled_date:m.translations.scheduled_date||"التاريخ المجدول",notes:m.translations.notes||"ملاحظات"})[i]||i;return(i,e)=>(d(),L(R,null,{header:S(()=>[t("div",Z,[t("h2",tt,s(n.translations.decoration_orders),1),$(j(N),{class:"btn btn-secondary",href:i.route("decorations.index")},{default:S(()=>[e[16]||(e[16]=t("i",{class:"bi bi-arrow-left"},null,-1)),r(" "+s(n.translations.cancel),1)]),_:1},8,["href"])])]),default:S(()=>{var F,E;return[t("div",st,[t("div",et,[t("div",at,[t("div",nt,[t("form",{onSubmit:P(T,["prevent"])},[t("div",lt,[t("div",ot,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=a=>f.search=a),placeholder:n.translations.search},null,8,it),[[A,f.search]])]),t("div",dt,[v(t("select",{class:"form-select","onUpdate:modelValue":e[1]||(e[1]=a=>f.status=a)},[t("option",ut,s(n.translations.all_status),1),t("option",ct,s(n.translations.created),1),t("option",rt,s(n.translations.received),1),t("option",mt,s(n.translations.executing),1),t("option",vt,s(n.translations.partial_payment),1),t("option",_t,s(n.translations.full_payment),1),t("option",bt,s(n.translations.completed),1),t("option",yt,s(n.translations.cancelled),1)],512),[[C,f.status]])]),t("div",ht,[t("button",ft,[e[17]||(e[17]=t("i",{class:"bi bi-search"},null,-1)),r(" "+s(n.translations.search),1)])])])],32)])]),t("div",gt,[t("div",pt,[t("div",xt,[t("table",kt,[t("thead",null,[t("tr",null,[t("th",null,s(n.translations.decoration),1),t("th",null,s(n.translations.customer_name),1),t("th",null,s(n.translations.event_date),1),t("th",null,s(n.translations.pricing),1),t("th",null,s(n.translations.status),1),t("th",null,s(n.translations.assigned_employee),1),t("th",null,s(n.translations.action),1)])]),t("tbody",null,[(d(!0),u(O,null,V(n.orders.data,a=>{var x,I;return d(),u("tr",{key:a.id},[t("td",null,[t("div",null,[t("strong",null,s((x=a.decoration)==null?void 0:x.name),1),e[18]||(e[18]=t("br",null,null,-1)),t("small",wt,s((I=a.decoration)==null?void 0:I.type_name),1)])]),t("td",null,[t("div",null,[r(s(a.customer_name)+" ",1),e[19]||(e[19]=t("br",null,null,-1)),t("small",St,s(a.customer_phone),1)])]),t("td",null,[r(s(H(a.event_date))+" ",1),e[20]||(e[20]=t("br",null,null,-1)),t("small",At,s(a.event_time),1)]),t("td",null,[t("div",$t,[t("div",jt,[t("small",null,s(n.translations.base_price)+":",1),t("small",null,s(a.base_price)+" "+s(g(a.currency)),1)]),a.additional_cost>0?(d(),u("div",Ct,[t("small",Vt,s(n.translations.additional_cost)+":",1),t("small",Ot,"+"+s(a.additional_cost)+" "+s(g(a.currency)),1)])):c("",!0),a.discount>0?(d(),u("div",Mt,[t("small",Ut,s(n.translations.discount)+":",1),t("small",Dt,"-"+s(a.discount)+" "+s(g(a.currency)),1)])):c("",!0),e[21]||(e[21]=t("hr",{class:"my-1"},null,-1)),t("div",Ft,[t("strong",null,s(n.translations.total_price)+":",1),t("strong",Et,s(a.total_price)+" "+s(g(a.currency)),1)]),t("div",It,[t("small",null,s(n.translations.paid_amount)+":",1),t("small",Bt,s(a.paid_amount||0)+" "+s(g(a.currency)),1)])])]),t("td",null,[t("span",{class:_(["badge",`bg-${a.status_color}`])},s(a.status_name),3)]),t("td",null,[a.assigned_employee?(d(),u("span",Lt,s(a.assigned_employee.name),1)):(d(),u("span",Nt,s(n.translations.not_assigned),1))]),t("td",null,[t("div",Pt,[$(j(N),{href:i.route("decoration.orders.show",a.id),class:"btn btn-outline-primary btn-sm"},{default:S(()=>[e[22]||(e[22]=t("i",{class:"bi bi-eye"},null,-1)),r(" "+s(n.translations.view),1)]),_:2},1032,["href"]),t("button",{onClick:Q=>z(a),class:"btn btn-outline-secondary btn-sm"},[e[23]||(e[23]=t("i",{class:"bi bi-pencil"},null,-1)),r(" "+s(n.translations.update_status),1)],8,Tt),t("button",{onClick:Q=>G(a),class:"btn btn-outline-warning btn-sm"},[e[24]||(e[24]=t("i",{class:"bi bi-calculator"},null,-1)),r(" "+s(n.translations.edit_pricing),1)],8,zt),t("a",{href:i.route("decoration.orders.print",a.id),target:"_blank",class:"btn btn-outline-info btn-sm"},[e[25]||(e[25]=t("i",{class:"bi bi-printer"},null,-1)),r(" "+s(n.translations.print_invoice),1)],8,Gt)])])])}),128))])])]),n.orders.data.length>0?(d(),u("div",qt,[$(W,{links:n.orders.links},null,8,["links"])])):(d(),u("div",Ht,[e[26]||(e[26]=t("i",{class:"bi bi-calendar-x text-muted",style:{"font-size":"4rem"}},null,-1)),t("h4",Jt,s(n.translations.no_orders),1),t("p",Kt,s(n.translations.no_orders_description),1)]))])])])]),b.value?(d(),u("div",Qt,[t("div",Rt,[t("div",Wt,[t("div",Xt,[t("h3",null,s(n.translations.update_status)+" - "+s((E=(F=h.value)==null?void 0:F.decoration)==null?void 0:E.name),1),t("button",{onClick:e[2]||(e[2]=a=>b.value=!1),class:"btn-close"})]),t("div",Yt,[Object.keys(l.value).length>0?(d(),u("div",Zt,[e[27]||(e[27]=t("h6",{class:"alert-heading"},[t("i",{class:"bi bi-exclamation-triangle"}),r(" يرجى تصحيح الأخطاء التالية: ")],-1)),t("ul",ts,[(d(!0),u(O,null,V(l.value,(a,x)=>(d(),u("li",{key:x},[t("strong",null,s(K(x))+":",1),r(" "+s(Array.isArray(a)?a[0]:a),1)]))),128))])])):c("",!0),t("form",{onSubmit:P(q,["prevent"])},[t("div",ss,[t("div",es,[t("div",as,[t("label",ns,s(n.translations.status),1),v(t("select",{class:_(["form-select",{"is-invalid":l.value.status}]),"onUpdate:modelValue":e[3]||(e[3]=a=>o.status=a),onChange:e[4]||(e[4]=a=>p("status"))},[t("option",ls,s(n.translations.select_type),1),t("option",os,s(n.translations.created),1),t("option",is,s(n.translations.received),1),t("option",ds,s(n.translations.executing),1),t("option",us,s(n.translations.partial_payment),1),t("option",cs,s(n.translations.full_payment),1),t("option",rs,s(n.translations.completed),1),t("option",ms,s(n.translations.cancelled),1)],34),[[C,o.status]]),l.value.status?(d(),u("div",vs,s(Array.isArray(l.value.status)?l.value.status[0]:l.value.status),1)):c("",!0),e[28]||(e[28]=t("small",{class:"text-muted"},"اترك فارغاً للاحتفاظ بالحالة الحالية",-1))])]),t("div",_s,[t("div",bs,[t("label",ys,s(n.translations.assign_employee),1),v(t("select",{class:_(["form-select",{"is-invalid":l.value.assigned_employee_id}]),"onUpdate:modelValue":e[5]||(e[5]=a=>o.assigned_employee_id=a),onChange:e[6]||(e[6]=a=>p("assigned_employee_id"))},[t("option",hs,s(n.translations.select_employee),1),(d(!0),u(O,null,V(n.employees,a=>(d(),u("option",{key:a.id,value:a.id},s(a.name),9,fs))),128))],34),[[C,o.assigned_employee_id]]),l.value.assigned_employee_id?(d(),u("div",gs,s(Array.isArray(l.value.assigned_employee_id)?l.value.assigned_employee_id[0]:l.value.assigned_employee_id),1)):c("",!0)])]),o.status==="partial_payment"||o.status==="full_payment"?(d(),u("div",ps,[t("div",xs,[t("label",ks,s(n.translations.paid_amount),1),v(t("input",{type:"number",step:"0.01",class:_(["form-control",{"is-invalid":l.value.paid_amount}]),"onUpdate:modelValue":e[7]||(e[7]=a=>o.paid_amount=a),onInput:e[8]||(e[8]=a=>p("paid_amount"))},null,34),[[A,o.paid_amount]]),l.value.paid_amount?(d(),u("div",ws,s(Array.isArray(l.value.paid_amount)?l.value.paid_amount[0]:l.value.paid_amount),1)):c("",!0)])])):c("",!0),t("div",Ss,[t("div",As,[t("label",$s,s(n.translations.scheduled_date),1),v(t("input",{type:"datetime-local",class:_(["form-control",{"is-invalid":l.value.scheduled_date}]),"onUpdate:modelValue":e[9]||(e[9]=a=>o.scheduled_date=a),onInput:e[10]||(e[10]=a=>p("scheduled_date"))},null,34),[[A,o.scheduled_date]]),l.value.scheduled_date?(d(),u("div",js,s(Array.isArray(l.value.scheduled_date)?l.value.scheduled_date[0]:l.value.scheduled_date),1)):c("",!0)])]),t("div",Cs,[t("div",Vs,[t("label",Os,s(n.translations.notes),1),v(t("textarea",{class:_(["form-control",{"is-invalid":l.value.notes}]),"onUpdate:modelValue":e[11]||(e[11]=a=>o.notes=a),rows:"3",onInput:e[12]||(e[12]=a=>p("notes"))},null,34),[[A,o.notes]]),l.value.notes?(d(),u("div",Ms,s(Array.isArray(l.value.notes)?l.value.notes[0]:l.value.notes),1)):c("",!0)])])]),t("div",Us,[t("button",{type:"button",class:"btn btn-secondary text-center w-100",onClick:e[13]||(e[13]=a=>b.value=!1)},s(n.translations.cancel),1),t("button",{type:"submit",class:"btn btn-primary w-100 text-center",disabled:y.value},[y.value?(d(),u("span",Fs)):c("",!0),r(" "+s(n.translations.update),1)],8,Ds)])],32)])])])])):c("",!0),w.value?(d(),L(X,{key:1,order:h.value,translations:n.translations,onClose:e[14]||(e[14]=a=>w.value=!1),onSuccess:e[15]||(e[15]=a=>{w.value=!1,j(M).reload()})},null,8,["order","translations"])):c("",!0)]}),_:1}))}},Ts=Y(Es,[["__scopeId","data-v-dd54868b"]]);export{Ts as default};
