import{r as m,T as h,a as o,h as $,w as j,b as e,d as i,c as r,t as d,e as y,l as A,x as B,u as b,n as x,j as V,D as g}from"./app-BdwRZgQZ.js";import{A as D}from"./AuthenticatedLayout-CSKvAGUW.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"section dashboard"},O={class:"card"},S={class:"card-body"},q={key:0,class:"alert alert-info mb-4"},I={class:"row"},M={class:"col-md-6"},z={class:"mb-1"},E={key:0,class:"mb-1"},F={key:1,class:"mb-1"},R={key:2,class:"mb-1"},U={class:"col-md-6"},G={class:"mb-1"},H={class:"mb-1"},J={key:1,class:"alert alert-danger alert-dismissible fade show",role:"alert"},K={key:2,class:"alert alert-success alert-dismissible fade show",role:"alert"},P={class:"row"},Q={class:"col-md-12 mb-3"},W={key:0,class:"invalid-feedback"},X={class:"card bg-light mb-3"},Y={class:"card-body"},Z={class:"row"},ss={class:"col-md-6"},es={class:"col-md-6"},ts={class:"small"},is={class:"mt-2"},ns=["disabled"],ls={class:"d-flex justify-content-between"},as=["disabled"],os=["disabled"],rs={key:0,class:"spinner-border spinner-border-sm me-2"},ds={key:1,class:"bi bi-key me-1"},cs={key:4,class:"text-center"},us=["disabled"],bs={key:0,class:"spinner-border spinner-border-sm me-2"},vs={key:1,class:"bi bi-x-circle me-1"},ms={__name:"Activate",props:{license:{type:Object,default:()=>({})},server:{type:Object,required:!0},translations:{type:Object,default:()=>({})}},setup(l){const k=l,c=m(""),u=m(""),p=m(!1),v=m(!1),f=m(!1),n=h({license_key:"",domain:k.server.domain,fingerprint:k.server.fingerprint}),_=async()=>{var a,s;c.value="",u.value="";try{const t=await g.post("/api/license/activate",{license_key:n.license_key,domain:n.domain,fingerprint:n.fingerprint});t.data.success?(u.value=t.data.message,n.license_key="",f.value=!1,setTimeout(()=>{window.location.reload()},2e3)):c.value=t.data.message||"فشل تفعيل الترخيص"}catch(t){c.value=((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||"حدث خطأ أثناء تفعيل الترخيص"}},C=async()=>{var a,s;if(confirm("هل أنت متأكد من إلغاء تفعيل الترخيص؟")){v.value=!0,c.value="",u.value="";try{const t=await g.post("/api/license/deactivate");t.data.success?(u.value=t.data.message,setTimeout(()=>{window.location.reload()},2e3)):c.value=t.data.message||"فشل إلغاء تفعيل الترخيص"}catch(t){c.value=((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||"حدث خطأ أثناء إلغاء تفعيل الترخيص"}finally{v.value=!1}}},T=async()=>{p.value=!0;try{const a=await g.get("/api/license/server-info");a.data.success&&(n.domain=a.data.domain,n.fingerprint=a.data.fingerprint,u.value="تم تحديث معلومات السيرفر بنجاح")}catch{c.value="فشل تحديث معلومات السيرفر"}finally{p.value=!1}},w=a=>{navigator.clipboard.writeText(a).then(()=>{u.value="تم النسخ بنجاح",setTimeout(()=>{u.value=""},2e3)}).catch(()=>{c.value="فشل النسخ"})};return(a,s)=>(o(),$(D,{translations:l.translations},{default:j(()=>[e("section",N,[e("div",O,[s[27]||(s[27]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},[e("i",{class:"bi bi-key me-2"}),i(" تفعيل الترخيص ")])],-1)),e("div",S,[l.license.activated?(o(),r("div",q,[s[13]||(s[13]=e("h6",{class:"alert-heading"},[e("i",{class:"bi bi-info-circle me-2"}),i(" الترخيص مفعل حالياً ")],-1)),s[14]||(s[14]=e("hr",null,null,-1)),e("div",I,[e("div",M,[e("p",z,[s[7]||(s[7]=e("strong",null,"النوع:",-1)),i(" "+d(l.license.type),1)]),l.license.expires_at?(o(),r("p",E,[s[8]||(s[8]=e("strong",null,"تاريخ الانتهاء:",-1)),i(" "+d(l.license.expires_at),1)])):(o(),r("p",F,s[9]||(s[9]=[e("strong",null,"النوع:",-1),i(" ترخيص دائم ")]))),l.license.days_remaining!==null?(o(),r("p",R,[s[10]||(s[10]=e("strong",null,"الأيام المتبقية:",-1)),i(" "+d(l.license.days_remaining)+" يوم ",1)])):y("",!0)]),e("div",U,[e("p",G,[s[11]||(s[11]=e("strong",null,"الدومين:",-1)),i(" "+d(l.server.domain),1)]),e("p",H,[s[12]||(s[12]=e("strong",null,"تاريخ التفعيل:",-1)),i(" "+d(l.license.activated_at),1)])])])])):y("",!0),c.value?(o(),r("div",J,[s[15]||(s[15]=e("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),i(" "+d(c.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=t=>c.value="")})])):y("",!0),u.value?(o(),r("div",K,[s[16]||(s[16]=e("i",{class:"bi bi-check-circle me-2"},null,-1)),i(" "+d(u.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:s[1]||(s[1]=t=>u.value="")})])):y("",!0),!l.license.activated||f.value?(o(),r("form",{key:3,onSubmit:V(_,["prevent"])},[e("div",P,[e("div",Q,[s[17]||(s[17]=e("label",{for:"license_key",class:"form-label"},[i(" مفتاح الترخيص "),e("span",{class:"text-danger"},"*")],-1)),A(e("textarea",{id:"license_key","onUpdate:modelValue":s[2]||(s[2]=t=>b(n).license_key=t),class:x(["form-control",{"is-invalid":b(n).errors.license_key}]),rows:"5",placeholder:"الصق مفتاح الترخيص هنا...",required:""},null,2),[[B,b(n).license_key]]),b(n).errors.license_key?(o(),r("div",W,d(b(n).errors.license_key),1)):y("",!0),s[18]||(s[18]=e("small",{class:"form-text text-muted"}," أدخل مفتاح الترخيص الذي حصلت عليه من المزود ",-1))])]),e("div",X,[s[24]||(s[24]=e("div",{class:"card-header"},[e("h6",{class:"card-title mb-0"},[e("i",{class:"bi bi-server me-2"}),i(" معلومات السيرفر ")])],-1)),e("div",Y,[e("div",Z,[e("div",ss,[s[20]||(s[20]=e("p",{class:"mb-1"},[e("strong",null,"الدومين:")],-1)),e("code",null,d(l.server.domain),1),e("button",{type:"button",class:"btn btn-sm btn-outline-secondary ms-2",onClick:s[3]||(s[3]=t=>w(l.server.domain)),title:"نسخ"},s[19]||(s[19]=[e("i",{class:"bi bi-clipboard"},null,-1)]))]),e("div",es,[s[22]||(s[22]=e("p",{class:"mb-1"},[e("strong",null,"Fingerprint:")],-1)),e("code",ts,d(l.server.fingerprint),1),e("button",{type:"button",class:"btn btn-sm btn-outline-secondary ms-2",onClick:s[4]||(s[4]=t=>w(l.server.fingerprint)),title:"نسخ"},s[21]||(s[21]=[e("i",{class:"bi bi-clipboard"},null,-1)]))])]),e("div",is,[e("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:T,disabled:p.value},[e("i",{class:x(["bi bi-arrow-clockwise me-1",{spinning:p.value}])},null,2),s[23]||(s[23]=i(" تحديث معلومات السيرفر "))],8,ns)])])]),e("div",ls,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[5]||(s[5]=t=>a.window.history.back()),disabled:b(n).processing},s[25]||(s[25]=[e("i",{class:"bi bi-arrow-right me-1"},null,-1),i(" رجوع ")]),8,as),e("button",{type:"submit",class:"btn btn-primary",disabled:b(n).processing||!b(n).license_key},[b(n).processing?(o(),r("span",rs)):(o(),r("i",ds)),i(" "+d(b(n).processing?"جاري التفعيل...":"تفعيل الترخيص"),1)],8,os)])],32)):(o(),r("div",cs,[e("button",{type:"button",class:"btn btn-warning me-2",onClick:s[6]||(s[6]=t=>f.value=!0)},s[26]||(s[26]=[e("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),i(" إعادة تفعيل ")])),e("button",{type:"button",class:"btn btn-danger",onClick:C,disabled:v.value},[v.value?(o(),r("span",bs)):(o(),r("i",vs)),i(" "+d(v.value?"جاري الإلغاء...":"إلغاء التفعيل"),1)],8,us)]))])])])]),_:1},8,["translations"]))}},gs=L(ms,[["__scopeId","data-v-242d8c7a"]]);export{gs as default};
