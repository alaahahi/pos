import{r as L,B as $,a as o,h as M,w as V,b as s,t as l,d as D,l as u,A as f,c as n,f as m,F as b,x as U,n as S,i as q,u as T,p as A,e as z,j as E,g as _}from"./app-DniDjs0a.js";import{_ as G}from"./AuthenticatedLayout-D_OBjHYh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"section dashboard"},J={class:"row mb-4"},K={class:"col-xl-3 col-md-6"},P={class:"card info-card"},Q={class:"card-body"},R={class:"d-flex align-items-center"},W={class:"ps-3"},X={class:"col-xl-3 col-md-6"},Y={class:"card info-card"},Z={class:"card-body"},ss={class:"d-flex align-items-center"},ts={class:"ps-3"},es={class:"col-xl-3 col-md-6"},ls={class:"card info-card"},os={class:"card-body"},as={class:"d-flex align-items-center"},ns={class:"ps-3"},is={class:"col-xl-3 col-md-6"},ds={class:"card info-card"},rs={class:"card-body"},cs={class:"d-flex align-items-center"},us={class:"ps-3"},ms={class:"card"},bs={class:"card-header"},vs={class:"d-flex justify-content-between align-items-center"},fs={class:"card-title mb-0"},_s={class:"card-body"},ys={class:"row mb-3"},ps={class:"col-md-3"},gs=["value"],hs={class:"col-md-3"},xs=["value"],ws={class:"col-md-3"},js=["value"],ks={class:"col-md-3"},Cs={class:"table-responsive"},Ls={class:"table table-striped"},Ms={scope:"row"},Vs={class:"badge bg-primary"},Ds={class:"d-flex gap-1"},Us=["onClick"],Ss={class:"d-flex justify-content-center mt-3"},Ts={class:"pagination"},As=["innerHTML"],Bs={class:"modal fade",id:"cleanLogsModal",tabindex:"-1"},Os={class:"modal-dialog"},Fs={class:"modal-content"},Hs={class:"modal-body"},Ns={class:"mb-3"},$s={class:"form-text"},Is={__name:"index",props:{logs:Object,users:Array,modules:Array,actions:Array,statistics:Object,filters:Object,translations:Object},setup(a){var y,p,g,h;const v=a,r=L(30),i=L({module_name:((y=v.filters)==null?void 0:y.module_name)||"",action:((p=v.filters)==null?void 0:p.action)||"",by_user_id:((g=v.filters)==null?void 0:g.by_user_id)||"",date:((h=v.filters)==null?void 0:h.date)||""}),c=()=>{_.get(route("logs"),i.value,{preserveState:!0,replace:!0})},B=d=>d?new Date(d).toLocaleDateString("ar-SA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",O=d=>["Created","Updated","Deleted"].includes(d.action),F=d=>{confirm("هل أنت متأكد من التراجع عن هذا الإجراء؟")&&_.post(route("logs.undo",d))},H=()=>{confirm(`هل أنت متأكد من حذف السجلات الأقدم من ${r.value} يوم؟`)&&_.post(route("logs.clean"),{days:r.value})};return $(i,()=>{c()},{deep:!0}),(d,t)=>(o(),M(G,{translations:a.translations},{default:V(()=>{var x,w,j,k;return[s("section",I,[s("div",J,[s("div",K,[s("div",P,[s("div",Q,[t[6]||(t[6]=s("h5",{class:"card-title"},"إجمالي السجلات",-1)),s("div",R,[t[5]||(t[5]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-journal-text"})],-1)),s("div",W,[s("h6",null,l(((x=a.statistics)==null?void 0:x.total)||0),1)])])])])]),s("div",X,[s("div",Y,[s("div",Z,[t[8]||(t[8]=s("h5",{class:"card-title"},"اليوم",-1)),s("div",ss,[t[7]||(t[7]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-calendar-day"})],-1)),s("div",ts,[s("h6",null,l(((w=a.statistics)==null?void 0:w.today)||0),1)])])])])]),s("div",es,[s("div",ls,[s("div",os,[t[10]||(t[10]=s("h5",{class:"card-title"},"هذا الأسبوع",-1)),s("div",as,[t[9]||(t[9]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-calendar-week"})],-1)),s("div",ns,[s("h6",null,l(((j=a.statistics)==null?void 0:j.this_week)||0),1)])])])])]),s("div",is,[s("div",ds,[s("div",rs,[t[12]||(t[12]=s("h5",{class:"card-title"},"هذا الشهر",-1)),s("div",cs,[t[11]||(t[11]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-calendar-month"})],-1)),s("div",us,[s("h6",null,l(((k=a.statistics)==null?void 0:k.this_month)||0),1)])])])])])]),s("div",ms,[s("div",bs,[s("div",vs,[s("h5",fs,[t[13]||(t[13]=s("i",{class:"bi bi-journal-text me-2"},null,-1)),D(" "+l(a.translations.logs),1)]),t[14]||(t[14]=s("div",{class:"d-flex gap-2"},[s("button",{type:"button",class:"btn btn-warning btn-sm","data-bs-toggle":"modal","data-bs-target":"#cleanLogsModal"},[s("i",{class:"bi bi-trash me-1"}),D(" تنظيف السجلات القديمة ")])],-1))])]),s("div",_s,[s("div",ys,[s("div",ps,[t[16]||(t[16]=s("label",{class:"form-label"},"الوحدة",-1)),u(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.value.module_name=e),onChange:c,class:"form-select"},[t[15]||(t[15]=s("option",{value:""},"جميع الوحدات",-1)),(o(!0),n(b,null,m(a.modules,e=>(o(),n("option",{key:e,value:e},l(e),9,gs))),128))],544),[[f,i.value.module_name]])]),s("div",hs,[t[18]||(t[18]=s("label",{class:"form-label"},"العملية",-1)),u(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.value.action=e),onChange:c,class:"form-select"},[t[17]||(t[17]=s("option",{value:""},"جميع العمليات",-1)),(o(!0),n(b,null,m(a.actions,e=>(o(),n("option",{key:e,value:e},l(e),9,xs))),128))],544),[[f,i.value.action]])]),s("div",ws,[t[20]||(t[20]=s("label",{class:"form-label"},"المستخدم",-1)),u(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.value.by_user_id=e),onChange:c,class:"form-select"},[t[19]||(t[19]=s("option",{value:""},"جميع المستخدمين",-1)),(o(!0),n(b,null,m(a.users,e=>(o(),n("option",{key:e.id,value:e.id},l(e.name),9,js))),128))],544),[[f,i.value.by_user_id]])]),s("div",ks,[t[21]||(t[21]=s("label",{class:"form-label"},"التاريخ",-1)),u(s("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=e=>i.value.date=e),onChange:c,class:"form-control"},null,544),[[U,i.value.date]])])]),s("div",Cs,[s("table",Ls,[t[24]||(t[24]=s("thead",null,[s("tr",null,[s("th",{scope:"col"},"#"),s("th",{scope:"col"},"المستخدم"),s("th",{scope:"col"},"الوحدة"),s("th",{scope:"col"},"العملية"),s("th",{scope:"col"},"معرف السجل"),s("th",{scope:"col"},"التاريخ"),s("th",{scope:"col"},"الإجراءات")])],-1)),s("tbody",null,[(o(!0),n(b,null,m(a.logs.data,(e,N)=>{var C;return o(),n("tr",{key:e.id},[s("th",Ms,l(N+1),1),s("td",null,l(((C=e.user)==null?void 0:C.name)||"غير محدد"),1),s("td",null,[s("span",Vs,l(e.module_name),1)]),s("td",null,[s("span",{class:S(["badge","bg-"+e.badge])},l(e.action),3)]),s("td",null,l(e.affected_record_id),1),s("td",null,l(B(e.created_at)),1),s("td",null,[s("div",Ds,[q(T(A),{href:d.route("logs.view",e.id),class:"btn btn-sm btn-outline-primary"},{default:V(()=>t[22]||(t[22]=[s("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),O(e)?(o(),n("button",{key:0,onClick:qs=>F(e.id),class:"btn btn-sm btn-outline-warning"},t[23]||(t[23]=[s("i",{class:"bi bi-arrow-counterclockwise"},null,-1)]),8,Us)):z("",!0)])])])}),128))])])]),s("div",Ss,[s("nav",null,[s("ul",Ts,[(o(!0),n(b,null,m(a.logs.links,e=>(o(),n("li",{key:e.label,class:S(["page-item",{active:e.active,disabled:!e.url}])},[e.url?(o(),M(T(A),{key:0,href:e.url,class:"page-link",innerHTML:e.label},null,8,["href","innerHTML"])):(o(),n("span",{key:1,class:"page-link",innerHTML:e.label},null,8,As))],2))),128))])])])])])]),s("div",Bs,[s("div",Os,[s("div",Fs,[t[27]||(t[27]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title"},"تنظيف السجلات القديمة"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),s("form",{onSubmit:E(H,["prevent"])},[s("div",Hs,[s("div",Ns,[t[25]||(t[25]=s("label",{class:"form-label"},"حذف السجلات الأقدم من (أيام)",-1)),u(s("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>r.value=e),class:"form-control",min:"1",max:"365",required:""},null,512),[[U,r.value]]),s("div",$s," سيتم حذف جميع السجلات الأقدم من "+l(r.value)+" يوم ",1)])]),t[26]||(t[26]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"إلغاء"),s("button",{type:"submit",class:"btn btn-warning"},"تنظيف")],-1))],32)])])])]}),_:1},8,["translations"]))}};export{Is as default};
