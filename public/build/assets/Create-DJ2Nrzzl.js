import{r as f,s as Q,T as R,k as z,B as A,C as H,a as u,h as G,w as I,b as s,t as l,i as m,d as v,n as d,j as M,l as c,H as C,u as i,x as g,c as b,e as x}from"./app-hyZiV4Sx.js";import{_ as J}from"./AuthenticatedLayout-BeBCZfZC.js";import{_ as h}from"./InputError-wktRe11A.js";import{l as K}from"./lodash-D12HjqaS.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"pagetitle dark:text-white"},Y={class:"dark:text-white"},Z={class:"breadcrumb"},ss={class:"breadcrumb-item"},ts={class:"breadcrumb-item"},es={class:"breadcrumb-item active dark:text-white"},os={class:"section dashboard"},ls={class:"row"},is={class:"col-lg-12"},as={class:"card"},ns={class:"card-header"},rs={class:"card-title mb-0"},ds={class:"text-muted mb-0"},cs={class:"card-body"},us={class:"row mb-4"},ms={class:"col-12"},vs={class:"progress-steps"},bs={class:"step-label"},ps={class:"step-label"},_s={class:"step-label"},gs={class:"step-label"},hs={class:"form-section"},fs={class:"section-title"},xs={class:"row mb-3"},ys={for:"inputName",class:"col-sm-2 col-form-label required"},ks={class:"col-sm-10"},ws={class:"input-group"},Vs=["placeholder"],qs={class:"form-text"},Cs={class:"row mb-3"},Bs={for:"inputBarcode",class:"col-sm-2 col-form-label"},Is={class:"col-sm-10"},Us={class:"input-group"},Ss=["placeholder"],Ns=["disabled","title"],Fs={key:0,class:"input-group-text"},Ms={key:1,class:"input-group-text text-danger"},Ps={key:2,class:"input-group-text text-success"},js={class:"form-text"},Es={class:"row mb-3"},$s={for:"inputModel",class:"col-sm-2 col-form-label"},Ds={class:"col-sm-10"},Ts={class:"input-group"},Ls=["placeholder"],Os={class:"form-text"},Qs={class:"row mb-3"},Rs={for:"inputOENumber",class:"col-sm-2 col-form-label"},zs={class:"col-sm-10"},As={class:"input-group"},Hs=["placeholder"],Gs={class:"form-text"},Js={class:"form-section"},Ks={class:"section-title"},Ws={class:"row mb-3"},Xs={for:"inputPriceCost",class:"col-sm-2 col-form-label"},Ys={class:"col-sm-10"},Zs={class:"input-group"},st=["placeholder"],tt={class:"input-group-text"},et={class:"form-text"},ot={class:"row mb-3"},lt={for:"inputPrice",class:"col-sm-2 col-form-label required"},it={class:"col-sm-10"},at={class:"input-group"},nt=["placeholder"],rt={class:"input-group-text"},dt={class:"form-text"},ct={key:0,class:"row mb-3"},ut={class:"col-sm-10"},mt={class:"alert alert-info"},vt={class:"form-section"},bt={class:"section-title"},pt={class:"row mb-3"},_t={for:"inputQuantity",class:"col-sm-2 col-form-label required"},gt={class:"col-sm-10"},ht={class:"input-group"},ft=["placeholder"],xt={class:"input-group-text"},yt={class:"form-text"},kt={class:"form-section"},wt={class:"section-title"},Vt={class:"row mb-3"},qt={for:"inputNote",class:"col-sm-2 col-form-label"},Ct={class:"col-sm-10"},Bt={class:"input-group"},It=["placeholder"],Ut={class:"form-text"},St={class:"row mb-3"},Nt={for:"inputdate",class:"col-sm-2 col-form-label"},Ft={class:"col-sm-10"},Mt={class:"input-group"},Pt={class:"form-text"},jt={class:"row mb-3"},Et={for:"inputImage",class:"col-sm-2 col-form-label"},$t={class:"col-sm-10"},Dt={key:0,class:"upload-placeholder"},Tt={class:"text-muted"},Lt={key:1,class:"image-preview"},Ot=["src","alt"],Qt=["value"],Rt={class:"form-text"},zt={class:"row mt-4"},At={class:"col-12"},Ht={class:"d-flex justify-content-between"},Gt=["disabled"],Jt=["disabled"],Kt={key:0,class:"bi bi-check-circle me-2"},Wt={key:1,class:"spinner-border spinner-border-sm me-2"},Xt={__name:"Create",props:{translations:Object},setup(o){const y=f(!1),k=Q(),a=f(1),w=f(null),q=f(null),r=f({checking:!1,isValid:!0,message:""}),V=f(null),B=f(null),e=R({name:"",model:"",oe_number:"",price_cost:null,price:null,quantity:null,notes:"",barcode:"",image:null}),U=z(()=>e.name&&e.price&&e.quantity),P=()=>{a.value<4&&a.value++},j=()=>{a.value>1&&a.value--},S=()=>{a.value===1&&e.name&&(a.value=2)},E=()=>{const p=Date.now().toString(),t=Math.floor(Math.random()*1e3).toString().padStart(3,"0");e.barcode=`BC${p.slice(-6)}${t}`,N(e.barcode),k.success("تم توليد باركود جديد")},$=async p=>{if(!p||p.length<3){r.value={checking:!1,isValid:!0,message:""};return}r.value.checking=!0;try{const _=await(await fetch(route("products.checkBarcodeUnique",p))).json();r.value={checking:!1,isValid:_.unique,message:_.message},_.unique||k.warning(_.message)}catch(t){console.error("Barcode validation error:",t),r.value={checking:!1,isValid:!1,message:"خطأ في التحقق من الباركود"}}},N=K.debounce($,500),F=()=>{e.price_cost&&e.price?(V.value=parseFloat(e.price)-parseFloat(e.price_cost),B.value=V.value/parseFloat(e.price_cost)*100):(V.value=null,B.value=null)},D=()=>{q.value.click()},T=p=>{const t=p.target.files[0];if(t){e.image=t;const _=new FileReader;_.onload=n=>{w.value=n.target.result},_.readAsDataURL(t)}},L=()=>{e.image=null,w.value=null,q.value&&(q.value.value="")},O=()=>{if(e.barcode&&!r.value.isValid){k.error("يجب إدخال باركود صحيح ومتاح");return}if(!U.value){k.error("يرجى ملء جميع الحقول المطلوبة");return}y.value=!0,e.post(route("products.store"),{onSuccess:()=>{y.value=!1,k.success("تم إنشاء المنتج بنجاح")},onError:()=>{y.value=!1,k.error("حدث خطأ أثناء إنشاء المنتج")}})};return A([()=>e.name,()=>e.price,()=>e.quantity],()=>{S()}),(p,t)=>{const _=H("Link");return u(),G(J,{translations:o.translations},{default:I(()=>[s("div",X,[s("h1",Y,l(o.translations.products),1),s("nav",null,[s("ol",Z,[s("li",ss,[m(_,{class:"nav-link dark:text-white",href:p.route("dashboard")},{default:I(()=>[v(l(o.translations.home),1)]),_:1},8,["href"])]),s("li",ts,[m(_,{class:"nav-link dark:text-white",href:p.route("products.index")},{default:I(()=>[v(l(o.translations.products),1)]),_:1},8,["href"])]),s("li",es,l(o.translations.create),1)])])]),s("section",os,[s("div",ls,[s("div",is,[s("div",as,[s("div",ns,[s("h5",rs,[t[10]||(t[10]=s("i",{class:"bi bi-plus-circle me-2"},null,-1)),v(" "+l(o.translations.add_new_product),1)]),s("p",ds,l(o.translations.add_new_product_description),1)]),s("div",cs,[s("div",us,[s("div",ms,[s("div",vs,[s("div",{class:d(["step",{active:a.value>=1,completed:a.value>1}])},[t[11]||(t[11]=s("div",{class:"step-number"},"1",-1)),s("div",bs,l(o.translations.basic_info),1)],2),s("div",{class:d(["step",{active:a.value>=2,completed:a.value>2}])},[t[12]||(t[12]=s("div",{class:"step-number"},"2",-1)),s("div",ps,l(o.translations.pricing),1)],2),s("div",{class:d(["step",{active:a.value>=3,completed:a.value>3}])},[t[13]||(t[13]=s("div",{class:"step-number"},"3",-1)),s("div",_s,l(o.translations.inventory),1)],2),s("div",{class:d(["step",{active:a.value>=4,completed:a.value>4}])},[t[14]||(t[14]=s("div",{class:"step-number"},"4",-1)),s("div",gs,l(o.translations.additional),1)],2)])])]),s("form",{onSubmit:M(O,["prevent"]),class:"needs-validation",novalidate:""},[c(s("div",hs,[s("h6",fs,[t[15]||(t[15]=s("i",{class:"bi bi-info-circle me-2"},null,-1)),v(" "+l(o.translations.basic_info),1)]),s("div",xs,[s("label",ys,l(o.translations.name),1),s("div",ks,[s("div",ws,[t[16]||(t[16]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-box-seam"})],-1)),c(s("input",{id:"inputName",type:"text",class:d(["form-control",{"is-invalid":i(e).errors.name}]),placeholder:o.translations.enter_product_name,"onUpdate:modelValue":t[0]||(t[0]=n=>i(e).name=n),required:"",onInput:S},null,42,Vs),[[g,i(e).name]])]),s("div",qs,l(o.translations.product_name_help),1),m(h,{message:i(e).errors.name},null,8,["message"])])]),s("div",Cs,[s("label",Bs,l(o.translations.barcode),1),s("div",Is,[s("div",Us,[t[21]||(t[21]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-upc-scan"})],-1)),c(s("input",{id:"inputBarcode",type:"text",class:d(["form-control",{"is-invalid":r.value.checking===!1&&!r.value.isValid,"is-valid":i(e).barcode&&r.value.isValid}]),placeholder:o.translations.enter_barcode_or_auto_generate,"onUpdate:modelValue":t[1]||(t[1]=n=>i(e).barcode=n),onInput:t[2]||(t[2]=n=>i(N)(i(e).barcode))},null,42,Ss),[[g,i(e).barcode]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:E,disabled:r.value.checking,title:o.translations.auto_generate_barcode},t[17]||(t[17]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1)]),8,Ns),r.value.checking?(u(),b("div",Fs,t[18]||(t[18]=[s("span",{class:"spinner-border spinner-border-sm",role:"status"},null,-1)]))):r.value.isValid?i(e).barcode&&r.value.isValid?(u(),b("div",Ps,t[20]||(t[20]=[s("i",{class:"bi bi-check-circle"},null,-1)]))):x("",!0):(u(),b("div",Ms,t[19]||(t[19]=[s("i",{class:"bi bi-exclamation-triangle"},null,-1)])))]),r.value.message?(u(),b("div",{key:0,class:d(["form-text",r.value.isValid?"text-success":"text-danger"])},l(r.value.message),3)):x("",!0),s("div",js,l(o.translations.barcode_help),1),m(h,{message:i(e).errors.barcode},null,8,["message"])])]),s("div",Es,[s("label",$s,l(o.translations.model)+" ("+l(o.translations.optional)+")",1),s("div",Ds,[s("div",Ts,[t[22]||(t[22]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-tag"})],-1)),c(s("input",{id:"inputModel",type:"text",class:d(["form-control",{"is-invalid":i(e).errors.model}]),placeholder:o.translations.enter_model_number,"onUpdate:modelValue":t[3]||(t[3]=n=>i(e).model=n)},null,10,Ls),[[g,i(e).model]])]),s("div",Os,l(o.translations.model_help),1),m(h,{message:i(e).errors.model},null,8,["message"])])]),s("div",Qs,[s("label",Rs,l(o.translations.oe_number),1),s("div",zs,[s("div",As,[t[23]||(t[23]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-hash"})],-1)),c(s("input",{id:"inputOENumber",type:"text",class:d(["form-control",{"is-invalid":i(e).errors.oe_number}]),placeholder:o.translations.enter_oe_number,"onUpdate:modelValue":t[4]||(t[4]=n=>i(e).oe_number=n)},null,10,Hs),[[g,i(e).oe_number]])]),s("div",Gs,l(o.translations.oe_number_help),1),m(h,{message:i(e).errors.oe_number},null,8,["message"])])])],512),[[C,a.value>=1]]),c(s("div",Js,[s("h6",Ks,[t[24]||(t[24]=s("i",{class:"bi bi-currency-dollar me-2"},null,-1)),v(" "+l(o.translations.pricing),1)]),s("div",Ws,[s("label",Xs,l(o.translations.price_cost),1),s("div",Ys,[s("div",Zs,[t[25]||(t[25]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-cart-plus"})],-1)),c(s("input",{id:"inputPriceCost",type:"number",step:"0.01",min:"0",class:d(["form-control",{"is-invalid":i(e).errors.price_cost}]),placeholder:o.translations.enter_cost_price,"onUpdate:modelValue":t[5]||(t[5]=n=>i(e).price_cost=n),onInput:F},null,42,st),[[g,i(e).price_cost]]),s("span",tt,l(o.translations.dinar),1)]),s("div",et,l(o.translations.cost_price_help),1),m(h,{message:i(e).errors.price_cost},null,8,["message"])])]),s("div",ot,[s("label",lt,l(o.translations.price),1),s("div",it,[s("div",at,[t[26]||(t[26]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-cash-stack"})],-1)),c(s("input",{id:"inputPrice",type:"number",step:"0.01",min:"0",class:d(["form-control",{"is-invalid":i(e).errors.price}]),placeholder:o.translations.enter_selling_price,"onUpdate:modelValue":t[6]||(t[6]=n=>i(e).price=n),required:"",onInput:F},null,42,nt),[[g,i(e).price]]),s("span",rt,l(o.translations.dinar),1)]),s("div",dt,l(o.translations.selling_price_help),1),m(h,{message:i(e).errors.price},null,8,["message"])])]),V.value!==null?(u(),b("div",ct,[t[28]||(t[28]=s("div",{class:"col-sm-2"},null,-1)),s("div",ut,[s("div",mt,[t[27]||(t[27]=s("i",{class:"bi bi-graph-up me-2"},null,-1)),s("strong",null,l(o.translations.profit_margin)+":",1),v(" "+l(V.value.toFixed(2))+" "+l(o.translations.dinar)+" ("+l(B.value.toFixed(1))+"%) ",1)])])])):x("",!0)],512),[[C,a.value>=2]]),c(s("div",vt,[s("h6",bt,[t[29]||(t[29]=s("i",{class:"bi bi-boxes me-2"},null,-1)),v(" "+l(o.translations.inventory),1)]),s("div",pt,[s("label",_t,l(o.translations.quantity),1),s("div",gt,[s("div",ht,[t[30]||(t[30]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-123"})],-1)),c(s("input",{id:"inputQuantity",type:"number",min:"0",class:d(["form-control",{"is-invalid":i(e).errors.quantity}]),placeholder:o.translations.enter_initial_quantity,"onUpdate:modelValue":t[7]||(t[7]=n=>i(e).quantity=n),required:""},null,10,ft),[[g,i(e).quantity]]),s("span",xt,l(o.translations.units),1)]),s("div",yt,l(o.translations.quantity_help),1),m(h,{message:i(e).errors.quantity},null,8,["message"])])])],512),[[C,a.value>=3]]),c(s("div",kt,[s("h6",wt,[t[31]||(t[31]=s("i",{class:"bi bi-info-square me-2"},null,-1)),v(" "+l(o.translations.additional),1)]),s("div",Vt,[s("label",qt,l(o.translations.note),1),s("div",Ct,[s("div",Bt,[t[32]||(t[32]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-journal-text"})],-1)),c(s("textarea",{id:"inputNote",class:d(["form-control",{"is-invalid":i(e).errors.notes}]),placeholder:o.translations.enter_notes_optional,"onUpdate:modelValue":t[8]||(t[8]=n=>i(e).notes=n),rows:"3"},null,10,It),[[g,i(e).notes]])]),s("div",Ut,l(o.translations.notes_help),1),m(h,{message:i(e).errors.notes},null,8,["message"])])]),s("div",St,[s("label",Nt,l(o.translations.date),1),s("div",Ft,[s("div",Mt,[t[33]||(t[33]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-calendar"})],-1)),c(s("input",{id:"inputdate",type:"date",class:d(["form-control",{"is-invalid":i(e).errors.date}]),"onUpdate:modelValue":t[9]||(t[9]=n=>i(e).date=n)},null,2),[[g,i(e).date]])]),s("div",Pt,l(o.translations.date_help),1),m(h,{message:i(e).errors.date},null,8,["message"])])]),s("div",jt,[s("label",Et,l(o.translations.image),1),s("div",$t,[s("div",{class:d(["image-upload-area",{"has-image":w.value}]),onClick:D},[s("input",{ref_key:"fileInput",ref:q,id:"inputImage",type:"file",accept:"image/*",onInput:T,style:{display:"none"}},null,544),w.value?(u(),b("div",Lt,[s("img",{src:w.value,alt:o.translations.product_image},null,8,Ot),s("button",{type:"button",class:"btn btn-sm btn-danger remove-image",onClick:M(L,["stop"])},t[35]||(t[35]=[s("i",{class:"bi bi-x"},null,-1)]))])):(u(),b("div",Dt,[t[34]||(t[34]=s("i",{class:"bi bi-cloud-upload"},null,-1)),s("p",null,l(o.translations.click_to_upload_image),1),s("small",Tt,l(o.translations.supported_formats),1)]))],2),i(e).progress?(u(),b("progress",{key:0,value:i(e).progress.percentage,max:"100",class:"w-100 mt-2"},l(i(e).progress.percentage)+"% ",9,Qt)):x("",!0),s("div",Rt,l(o.translations.image_help),1)])])],512),[[C,a.value>=4]]),s("div",zt,[s("div",At,[s("div",Ht,[s("button",{type:"button",class:"btn btn-outline-secondary",onClick:j,disabled:a.value===1},[t[36]||(t[36]=s("i",{class:"bi bi-arrow-left me-2"},null,-1)),v(" "+l(o.translations.previous),1)],8,Gt),s("div",null,[a.value<4?(u(),b("button",{key:0,type:"button",class:"btn btn-primary me-2",onClick:P},[v(l(o.translations.next)+" ",1),t[37]||(t[37]=s("i",{class:"bi bi-arrow-right ms-2"},null,-1))])):x("",!0),s("button",{type:"submit",class:"btn btn-success",disabled:y.value||!U.value},[y.value?x("",!0):(u(),b("i",Kt)),y.value?(u(),b("span",Wt)):x("",!0),v(" "+l(o.translations.save),1)],8,Jt)])])])])],32)])])])])])]),_:1},8,["translations"])}}},oe=W(Xt,[["__scopeId","data-v-3f22b75b"]]);export{oe as default};
