import{s as $,z,g as V,a as d,h as q,w as g,b as t,d as c,t as o,i as x,u as v,p as y,l as w,x as I,A as G,c as b,f as A,F as L,e as H}from"./app-lkIUTnz8.js";import{A as J}from"./AuthenticatedLayout-D5CayEyh.js";import{_ as K}from"./Pagination-DP6pYy9V.js";import{l as P}from"./lodash-Aq7Frfxg.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={dir:"rtl",lang:"ar"},W={class:"section dashboard"},X={class:"row mb-4"},Z={class:"col-xl-3 col-md-6"},tt={class:"card info-card sales-card"},st={class:"card-body"},et={class:"d-flex align-items-center"},lt={class:"ps-3"},nt={class:"col-xl-3 col-md-6"},ot={class:"card info-card revenue-card"},it={class:"card-body"},at={class:"d-flex align-items-center"},rt={class:"ps-3"},dt={class:"col-xl-3 col-md-6"},ct={class:"card info-card customers-card"},ut={class:"card-body"},pt={class:"d-flex align-items-center"},mt={class:"ps-3"},ft={class:"col-xl-3 col-md-6"},bt={class:"card info-card revenue-card"},vt={class:"card-body"},ht={class:"d-flex align-items-center"},_t={class:"ps-3"},gt={class:"card"},xt={class:"card-header d-flex justify-content-between align-items-center"},yt={class:"d-flex gap-2"},wt={class:"card-body"},It={class:"row mb-4"},kt={class:"col-md-4"},Dt={class:"search-box"},Mt={class:"col-md-2"},St=["value"],Ft={class:"col-md-2"},Ct={class:"col-md-2"},jt={class:"table-responsive"},Vt={class:"table table-hover"},At={class:"invoice-number"},Lt={key:0,class:"supplier-info"},Ut={class:"text-muted"},Yt={key:1,class:"text-muted"},Tt={class:"date-text"},Bt={class:"badge bg-info"},Nt={class:"amount-info"},Et={class:"text-success"},Ot={class:"creator-info"},$t={class:"date-text"},zt={class:"action-buttons"},qt={class:"btn-group",role:"group"},Gt=["onClick"],Ht={key:0,class:"text-center py-5"},Jt={__name:"Index",props:{purchaseInvoices:Object,suppliers:Array,filters:Object,translations:Object},setup(u){var M,S,F,C;const i=u,k=$(),n=z({search:((M=i.filters)==null?void 0:M.search)||"",supplier_id:((S=i.filters)==null?void 0:S.supplier_id)||"",date_from:((F=i.filters)==null?void 0:F.date_from)||"",date_to:((C=i.filters)==null?void 0:C.date_to)||""}),D=P.debounce(()=>{h()},500),h=()=>{V.get(route("purchase-invoices.index"),n,{preserveState:!0,replace:!0})},U=()=>{n.search="",n.supplier_id="",n.date_from="",n.date_to="",h()},Y=l=>l?new Date(l).toLocaleDateString("en-US"):"-",T=l=>l?new Date(l).toLocaleString("en-US"):"-",B=()=>{var m;if(!((m=i.purchaseInvoices)!=null&&m.data))return"0";const l=new Date().getMonth(),s=new Date().getFullYear(),_=i.purchaseInvoices.data.filter(r=>{const a=new Date(r.invoice_date);return a.getMonth()===l&&a.getFullYear()===s}).reduce((r,a)=>r+parseFloat(a.total_amount),0);return Math.round(_).toLocaleString()},N=()=>i.suppliers?i.suppliers.length:0,E=()=>{var r,a;if(!((a=(r=i.purchaseInvoices)==null?void 0:r.data)!=null&&a.length))return"0";const l=new Date().getMonth(),s=new Date().getFullYear(),p=i.purchaseInvoices.data.filter(e=>{const f=new Date(e.invoice_date);return f.getMonth()===l&&f.getFullYear()===s});if(!p.length)return"0";const m=p.reduce((e,f)=>e+parseFloat(f.total_amount),0)/p.length;return Math.round(m).toLocaleString()},O=l=>{confirm(`هل أنت متأكد من حذف فاتورة المشتريات رقم ${l.invoice_number}؟`)&&V.delete(route("purchase-invoices.destroy",l.id),{onSuccess:()=>{k.success("تم حذف فاتورة المشتريات بنجاح")},onError:()=>{k.error("حدث خطأ أثناء حذف فاتورة المشتريات")}})};return(l,s)=>(d(),q(J,{translations:u.translations},{default:g(()=>{var p,_,m,r,a;return[t("div",R,[t("section",W,[t("div",X,[t("div",Z,[t("div",tt,[t("div",st,[s[7]||(s[7]=t("h5",{class:"card-title"},[c("إجمالي الفواتير "),t("span",null,"| جميع الفواتير")],-1)),t("div",et,[s[6]||(s[6]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-receipt"})],-1)),t("div",lt,[t("h6",null,o(((p=u.purchaseInvoices)==null?void 0:p.total)||0),1),s[5]||(s[5]=t("span",{class:"text-success small pt-1 fw-bold"},"فاتورة",-1))])])])])]),t("div",nt,[t("div",ot,[t("div",it,[s[10]||(s[10]=t("h5",{class:"card-title"},[c("إجمالي المشتريات "),t("span",null,"| هذا الشهر")],-1)),t("div",at,[s[9]||(s[9]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-currency-dollar"})],-1)),t("div",rt,[t("h6",null,o(B()),1),s[8]||(s[8]=t("span",{class:"text-primary small pt-1 fw-bold"},"دينار",-1))])])])])]),t("div",dt,[t("div",ct,[t("div",ut,[s[13]||(s[13]=t("h5",{class:"card-title"},[c("عدد الموردين "),t("span",null,"| نشط")],-1)),t("div",pt,[s[12]||(s[12]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-people"})],-1)),t("div",mt,[t("h6",null,o(N()),1),s[11]||(s[11]=t("span",{class:"text-success small pt-1 fw-bold"},"مورد",-1))])])])])]),t("div",ft,[t("div",bt,[t("div",vt,[s[16]||(s[16]=t("h5",{class:"card-title"},[c("متوسط الفاتورة "),t("span",null,"| هذا الشهر")],-1)),t("div",ht,[s[15]||(s[15]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-graph-up"})],-1)),t("div",_t,[t("h6",null,o(E()),1),s[14]||(s[14]=t("span",{class:"text-info small pt-1 fw-bold"},"دينار",-1))])])])])])]),t("div",gt,[t("div",xt,[s[18]||(s[18]=t("h5",{class:"card-title mb-0"},[t("i",{class:"bi bi-receipt me-2"}),c(" إدارة فواتير المشتريات ")],-1)),t("div",yt,[x(v(y),{href:l.route("purchase-invoices.create"),class:"btn btn-primary"},{default:g(()=>s[17]||(s[17]=[t("i",{class:"bi bi-plus-circle"},null,-1),c(" إنشاء فاتورة جديدة ")])),_:1},8,["href"])])]),t("div",wt,[t("div",It,[t("div",kt,[t("div",Dt,[w(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=e=>n.search=e),placeholder:"ابحث برقم الفاتورة أو المورد...",onInput:s[1]||(s[1]=(...e)=>v(D)&&v(D)(...e))},null,544),[[I,n.search]]),s[19]||(s[19]=t("i",{class:"bi bi-search search-icon"},null,-1))])]),t("div",Mt,[w(t("select",{class:"form-select","onUpdate:modelValue":s[2]||(s[2]=e=>n.supplier_id=e),onChange:h},[s[20]||(s[20]=t("option",{value:""},"جميع الموردين",-1)),(d(!0),b(L,null,A(u.suppliers,e=>(d(),b("option",{key:e.id,value:e.id},o(e.name),9,St))),128))],544),[[G,n.supplier_id]])]),t("div",Ft,[w(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=e=>n.date_from=e),onChange:h,placeholder:"من تاريخ"},null,544),[[I,n.date_from]])]),t("div",Ct,[w(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=e=>n.date_to=e),onChange:h,placeholder:"إلى تاريخ"},null,544),[[I,n.date_to]])]),t("div",{class:"col-md-2"},[t("button",{class:"btn btn-outline-secondary w-100",onClick:U},s[21]||(s[21]=[t("i",{class:"bi bi-arrow-clockwise"},null,-1),c(" مسح الفلاتر ")]))])]),t("div",jt,[t("table",Vt,[s[26]||(s[26]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"رقم الفاتورة"),t("th",null,"المورد"),t("th",null,"تاريخ الفاتورة"),t("th",null,"عدد المنتجات"),t("th",null,"المبلغ الإجمالي"),t("th",null,"أنشأ بواسطة"),t("th",null,"تاريخ الإنشاء"),t("th",{class:"text-center"},"الإجراءات")])],-1)),t("tbody",null,[(d(!0),b(L,null,A((_=u.purchaseInvoices)==null?void 0:_.data,e=>{var f,j;return d(),b("tr",{key:e.id,class:"invoice-row"},[t("td",null,[t("div",At,[t("strong",null,o(e.invoice_number),1)])]),t("td",null,[e.supplier?(d(),b("div",Lt,[t("strong",null,o(e.supplier.name),1),s[22]||(s[22]=t("br",null,null,-1)),t("small",Ut,o(e.supplier.phone),1)])):(d(),b("span",Yt,"غير محدد"))]),t("td",null,[t("span",Tt,o(Y(e.invoice_date)),1)]),t("td",null,[t("span",Bt,o(((f=e.items)==null?void 0:f.length)||0)+" منتج",1)]),t("td",null,[t("div",Nt,[t("strong",Et,o(Math.round(e.total_amount))+" دينار",1)])]),t("td",null,[t("div",Ot,[t("strong",null,o((j=e.creator)==null?void 0:j.name),1)])]),t("td",null,[t("span",$t,o(T(e.created_at)),1)]),t("td",null,[t("div",zt,[t("div",qt,[x(v(y),{href:l.route("purchase-invoices.show",e.id),class:"btn btn-sm btn-outline-primary",title:"عرض التفاصيل"},{default:g(()=>s[23]||(s[23]=[t("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),x(v(y),{href:l.route("purchase-invoices.edit",e.id),class:"btn btn-sm btn-outline-warning",title:"تعديل"},{default:g(()=>s[24]||(s[24]=[t("i",{class:"bi bi-pencil"},null,-1)])),_:2},1032,["href"]),t("button",{onClick:Kt=>O(e),class:"btn btn-sm btn-outline-danger",title:"حذف"},s[25]||(s[25]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Gt)])])])])}),128))])])]),(r=(m=u.purchaseInvoices)==null?void 0:m.data)!=null&&r.length?H("",!0):(d(),b("div",Ht,[s[28]||(s[28]=t("i",{class:"bi bi-receipt display-1 text-muted"},null,-1)),s[29]||(s[29]=t("h5",{class:"text-muted mt-3"},"لا توجد فواتير مشتريات",-1)),s[30]||(s[30]=t("p",{class:"text-muted"},"ابدأ بإنشاء فاتورة مشتريات جديدة",-1)),x(v(y),{href:l.route("purchase-invoices.create"),class:"btn btn-primary"},{default:g(()=>s[27]||(s[27]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),c(" إنشاء فاتورة جديدة ")])),_:1},8,["href"])]))])]),x(K,{links:(a=u.purchaseInvoices)==null?void 0:a.links},null,8,["links"])])])]}),_:1},8,["translations"]))}},Zt=Q(Jt,[["__scopeId","data-v-043c7787"]]);export{Zt as default};
