import{r as f,z as w,o as $,a,c as r,b as t,d as l,t as u,e as _,j,l as c,x as y,A as F,u as I,n as M,D as C}from"./app-HEdDoXdd.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"min-h-screen bg-light d-flex align-items-center justify-content-center py-5"},B={class:"container"},N={class:"row justify-content-center"},G={class:"col-md-8"},L={class:"card shadow"},A={class:"card-body"},E={key:0,class:"alert alert-success alert-dismissible fade show",role:"alert"},K={key:1,class:"alert alert-danger alert-dismissible fade show",role:"alert"},O={class:"row"},R={class:"col-md-6 mb-3"},q={class:"col-md-6 mb-3"},H={class:"col-md-6 mb-3"},J={class:"col-md-6 mb-3"},Q=["min"],W={class:"col-md-6 mb-3"},X={class:"card bg-light mb-3"},Y={class:"card-body"},Z={class:"row"},h={class:"col-md-6"},ss={class:"col-md-6"},ts={class:"small"},es={class:"mt-2"},ns=["disabled"],ls={class:"d-flex justify-content-end"},is=["disabled"],os={key:0,class:"spinner-border spinner-border-sm me-2"},as={key:1,class:"bi bi-key me-1"},rs={key:3,class:"generated-key-section"},ds={class:"alert alert-success"},ms={class:"mb-2"},us={key:0,class:"mb-2"},ps={key:1,class:"mb-2"},bs={class:"mb-2"},cs={class:"mb-3"},vs={class:"input-group"},fs={class:"d-flex justify-content-between"},ys={__name:"Generate",setup(gs){const d=f(""),i=f(""),g=f(!1),p=f(""),b=f({}),S=new Date().toISOString().split("T")[0],m=w({domain:"",fingerprint:""}),e=w({domain:"",fingerprint:"",type:"standard",expires_at:"",max_installations:1,processing:!1}),T=async()=>{var o,s;d.value="",i.value="",e.processing=!0;try{const D=new URLSearchParams(window.location.search).get("password"),v=await C.post("/api/license/generate",{password:D,domain:e.domain||void 0,fingerprint:e.fingerprint||void 0,type:e.type,expires_at:e.expires_at||void 0,max_installations:e.max_installations});v.data.success?(p.value=v.data.license_key,b.value=v.data.license_data,i.value=v.data.message):d.value=v.data.message||"فشل توليد مفتاح الترخيص"}catch(n){d.value=((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||"حدث خطأ أثناء توليد مفتاح الترخيص"}finally{e.processing=!1}},k=async()=>{g.value=!0;try{const o=await C.get("/api/license/server-info");o.data.success&&(m.domain=o.data.domain,m.fingerprint=o.data.fingerprint,i.value="تم تحديث معلومات السيرفر بنجاح",setTimeout(()=>{i.value=""},2e3))}catch{d.value="فشل تحديث معلومات السيرفر"}finally{g.value=!1}},V=()=>{e.domain=m.domain,e.fingerprint=m.fingerprint,i.value="تم استخدام معلومات السيرفر الحالي",setTimeout(()=>{i.value=""},2e3)},x=o=>{navigator.clipboard.writeText(o).then(()=>{i.value="تم النسخ بنجاح",setTimeout(()=>{i.value=""},2e3)}).catch(()=>{d.value="فشل النسخ"})},U=()=>{p.value="",b.value={},e.domain="",e.fingerprint="",e.type="standard",e.expires_at="",e.max_installations=1};return $(()=>{k()}),(o,s)=>(a(),r("div",z,[t("div",B,[t("div",N,[t("div",G,[t("div",L,[s[41]||(s[41]=t("div",{class:"card-header bg-primary text-white"},[t("h5",{class:"card-title mb-0"},[t("i",{class:"bi bi-key me-2"}),l(" توليد مفتاح الترخيص ")])],-1)),t("div",A,[i.value?(a(),r("div",E,[s[12]||(s[12]=t("i",{class:"bi bi-check-circle me-2"},null,-1)),l(" "+u(i.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=n=>i.value="")})])):_("",!0),d.value?(a(),r("div",K,[s[13]||(s[13]=t("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),l(" "+u(d.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:s[1]||(s[1]=n=>d.value="")})])):_("",!0),p.value?(a(),r("div",rs,[t("div",ds,[s[34]||(s[34]=t("h6",{class:"alert-heading"},[t("i",{class:"bi bi-check-circle me-2"}),l(" تم توليد مفتاح الترخيص بنجاح! ")],-1)),s[35]||(s[35]=t("hr",null,null,-1)),t("p",ms,[s[30]||(s[30]=t("strong",null,"نوع الترخيص:",-1)),l(" "+u(b.value.type),1)]),b.value.expires_at?(a(),r("p",us,[s[31]||(s[31]=t("strong",null,"تاريخ الانتهاء:",-1)),l(" "+u(b.value.expires_at),1)])):(a(),r("p",ps,s[32]||(s[32]=[t("strong",null,"النوع:",-1),l(" ترخيص دائم ")]))),t("p",bs,[s[33]||(s[33]=t("strong",null,"الدومين:",-1)),l(" "+u(b.value.domain),1)])]),t("div",cs,[s[37]||(s[37]=t("label",{class:"form-label"},[t("strong",null,"مفتاح الترخيص:")],-1)),t("div",vs,[c(t("textarea",{"onUpdate:modelValue":s[9]||(s[9]=n=>p.value=n),class:"form-control font-monospace",rows:"6",readonly:"",style:{"font-size":"0.85em"}},null,512),[[y,p.value]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:s[10]||(s[10]=n=>x(p.value)),title:"نسخ"},s[36]||(s[36]=[t("i",{class:"bi bi-clipboard"},null,-1)]))]),s[38]||(s[38]=t("small",{class:"form-text text-muted"}," ⚠️ احفظ هذا المفتاح في مكان آمن. لن تتمكن من رؤيته مرة أخرى. ",-1))]),t("div",fs,[t("button",{type:"button",class:"btn btn-secondary",onClick:U},s[39]||(s[39]=[t("i",{class:"bi bi-arrow-right me-1"},null,-1),l(" توليد مفتاح جديد ")])),t("button",{type:"button",class:"btn btn-success",onClick:s[11]||(s[11]=n=>x(p.value))},s[40]||(s[40]=[t("i",{class:"bi bi-clipboard me-1"},null,-1),l(" نسخ المفتاح ")]))])])):(a(),r("form",{key:2,onSubmit:j(T,["prevent"])},[t("div",O,[t("div",R,[s[14]||(s[14]=t("label",{for:"domain",class:"form-label"},"الدومين",-1)),c(t("input",{type:"text",id:"domain","onUpdate:modelValue":s[2]||(s[2]=n=>e.domain=n),class:"form-control",placeholder:"example.com"},null,512),[[y,e.domain]]),s[15]||(s[15]=t("small",{class:"form-text text-muted"},"اتركه فارغاً لاستخدام الدومين الحالي",-1))]),t("div",q,[s[16]||(s[16]=t("label",{for:"fingerprint",class:"form-label"},"Fingerprint",-1)),c(t("input",{type:"text",id:"fingerprint","onUpdate:modelValue":s[3]||(s[3]=n=>e.fingerprint=n),class:"form-control",placeholder:"Server Fingerprint"},null,512),[[y,e.fingerprint]]),s[17]||(s[17]=t("small",{class:"form-text text-muted"},"اتركه فارغاً لاستخدام Fingerprint الحالي",-1))]),t("div",H,[s[19]||(s[19]=t("label",{for:"type",class:"form-label"},"نوع الترخيص",-1)),c(t("select",{id:"type","onUpdate:modelValue":s[4]||(s[4]=n=>e.type=n),class:"form-select"},s[18]||(s[18]=[t("option",{value:"trial"},"تجريبي (Trial)",-1),t("option",{value:"standard"},"عادي (Standard)",-1),t("option",{value:"premium"},"مميز (Premium)",-1)]),512),[[F,e.type]])]),t("div",J,[s[20]||(s[20]=t("label",{for:"expires_at",class:"form-label"},"تاريخ الانتهاء",-1)),c(t("input",{type:"date",id:"expires_at","onUpdate:modelValue":s[5]||(s[5]=n=>e.expires_at=n),class:"form-control",min:I(S)},null,8,Q),[[y,e.expires_at]]),s[21]||(s[21]=t("small",{class:"form-text text-muted"},"اتركه فارغاً لترخيص دائم",-1))]),t("div",W,[s[22]||(s[22]=t("label",{for:"max_installations",class:"form-label"},"عدد التثبيتات المسموح بها",-1)),c(t("input",{type:"number",id:"max_installations","onUpdate:modelValue":s[6]||(s[6]=n=>e.max_installations=n),class:"form-control",min:"1"},null,512),[[y,e.max_installations,void 0,{number:!0}]])])]),t("div",X,[s[29]||(s[29]=t("div",{class:"card-header"},[t("h6",{class:"card-title mb-0"},[t("i",{class:"bi bi-server me-2"}),l(" معلومات السيرفر الحالي ")])],-1)),t("div",Y,[t("div",Z,[t("div",h,[s[24]||(s[24]=t("p",{class:"mb-1"},[t("strong",null,"الدومين:")],-1)),t("code",null,u(m.domain),1),t("button",{type:"button",class:"btn btn-sm btn-outline-secondary ms-2",onClick:s[7]||(s[7]=n=>x(m.domain)),title:"نسخ"},s[23]||(s[23]=[t("i",{class:"bi bi-clipboard"},null,-1)]))]),t("div",ss,[s[26]||(s[26]=t("p",{class:"mb-1"},[t("strong",null,"Fingerprint:")],-1)),t("code",ts,u(m.fingerprint),1),t("button",{type:"button",class:"btn btn-sm btn-outline-secondary ms-2",onClick:s[8]||(s[8]=n=>x(m.fingerprint)),title:"نسخ"},s[25]||(s[25]=[t("i",{class:"bi bi-clipboard"},null,-1)]))])]),t("div",es,[t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:k,disabled:g.value},[t("i",{class:M(["bi bi-arrow-clockwise me-1",{spinning:g.value}])},null,2),s[27]||(s[27]=l(" تحديث معلومات السيرفر "))],8,ns),t("button",{type:"button",class:"btn btn-sm btn-outline-success ms-2",onClick:V},s[28]||(s[28]=[t("i",{class:"bi bi-check-circle me-1"},null,-1),l(" استخدام معلومات السيرفر الحالي ")]))])])]),t("div",ls,[t("button",{type:"submit",class:"btn btn-primary",disabled:e.processing},[e.processing?(a(),r("span",os)):(a(),r("i",as)),l(" "+u(e.processing?"جاري التوليد...":"توليد مفتاح الترخيص"),1)],8,is)])],32))])])])])])]))}},ws=P(ys,[["__scopeId","data-v-eca8dd6e"]]);export{ws as default};
