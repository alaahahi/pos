import{r as x,T as I,z as w,k as P,B as $,a as c,h as N,w as S,b as t,t as l,j as T,i as _,u as y,c as m,F as j,f as E,l as f,x as V,e as h,d as D}from"./app-CSuMz0Jo.js";import{A as F}from"./AuthenticatedLayout-CfED7tvs.js";import{_ as L}from"./InputError-CCMf5sV9.js";import{C as q}from"./vue-select-BqdLiPx0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"section dashboard"},z={class:"row"},Q={class:"col-lg-12"},G={class:"card"},H={class:"card-body"},J={class:"card-title"},K={class:"row mb-3"},R={for:"customerSelect",class:"col-sm-2 col-form-label"},W={class:"col-sm-10"},X={key:0,class:"row mb-3"},Y={for:"productTable",class:"col-sm-2 col-form-label"},Z={class:"col-sm-10"},tt={class:"table"},et=["onInput","onUpdate:modelValue","max"],st=["onUpdate:modelValue"],ot=["value"],at=["onClick"],lt={class:"row"},nt={class:"col-md-6"},rt={class:"col-md-6"},dt={class:"text-center"},ct=["disabled"],it={key:0,class:"bi bi-save"},ut={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},_t={__name:"Edit",props:{order:Object,products:Array,customers:Array,translations:Object},setup(o){const i=x(!1),r=o,p=x(r.customers.find(s=>s.id===r.order.customer_id)||null),d=I({id:r.order.id,customer_id:r.order.customer_id,items:r.order.items||[],total_amount:r.order.total_amount||0}),b=w(d.items);w([]);const g=s=>{const a=r.products.find(u=>u.id===s.product_id);a&&(s.price=a.price)},C=s=>{const a=r.products.find(u=>u.id===s.product_id);a&&s.quantity>a.max_quantity&&(s.quantity=a.max_quantity)},v=P(()=>b.reduce((s,a)=>s+a.quantity*a.price,0));$(v,s=>{d.total_amount=s});const U=()=>{b.push({product_id:"",quantity:1,price:0,canadd:"true"})},M=s=>{b.splice(s,1)},A=s=>{p.value=s,d.customer_id=s?s.id:null},B=()=>{i.value=!0,d.items=b,d.put(route("orders.update",d.id),{onSuccess:()=>{i.value=!1},onError:()=>{i.value=!1}})};return(s,a)=>(c(),N(F,{translations:o.translations},{default:S(()=>{var u;return[t("section",O,[t("div",z,[t("div",Q,[t("div",G,[t("div",H,[t("h5",J,l(o.translations.edit_order),1),t("form",{onSubmit:T(B,["prevent"]),class:"row g-3"},[t("div",K,[t("label",R,l(o.translations.client),1),t("div",W,[_(y(q),{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),options:o.customers,label:"name","track-by":"id",reduce:e=>({id:e.id,name:e.name}),clearable:!0,placeholder:o.translations.select_customer,onMouseleave:a[1]||(a[1]=e=>A(p.value))},null,8,["modelValue","options","reduce","placeholder"]),_(L,{message:y(d).errors.customer},null,8,["message"])])]),p.value?(c(),m("div",X,[t("label",Y,l(o.translations.products),1),t("div",Z,[t("table",tt,[t("thead",null,[t("tr",null,[t("th",null,l(o.translations.product),1),t("th",null,l(o.translations.quantity),1),t("th",null,l(o.translations.price),1),t("th",null,l(o.translations.total),1),t("th",null,l(o.translations.actions),1)])]),t("tbody",null,[(c(!0),m(j,null,E(b,(e,k)=>(c(),m("tr",{key:k},[_(y(q),{modelValue:e.product_id,"onUpdate:modelValue":n=>e.product_id=n,options:o.products,label:"name",disabled:e.canadd!="true",reduce:n=>n.id,placeholder:o.translations.select_product,class:"form-control",style:{"min-width":"200px"},onMouseleave:n=>g(e)},null,8,["modelValue","onUpdate:modelValue","options","disabled","reduce","placeholder","onMouseleave"]),t("td",null,[f(t("input",{type:"number",onInput:n=>C(e),"onUpdate:modelValue":n=>e.quantity=n,min:"1",max:e.max_quantity,class:"form-control",placeholder:"Quantity"},null,40,et),[[V,e.quantity]])]),t("td",null,[f(t("input",{type:"number","onUpdate:modelValue":n=>e.price=n,min:"0",class:"form-control",placeholder:"Price"},null,8,st),[[V,e.price]])]),t("td",null,[t("input",{type:"number",value:e.quantity*e.price,class:"form-control",disabled:""},null,8,ot)]),t("td",null,[t("button",{type:"button",class:"btn btn-danger",onClick:n=>M(k)},a[3]||(a[3]=[t("i",{class:"bi bi-trash"},null,-1)]),8,at)])]))),128))])]),(u=o.products)!=null&&u.length?(c(),m("button",{key:0,type:"button",class:"btn btn-primary",onClick:U},l(o.translations.add_product),1)):h("",!0)])])):h("",!0),t("div",lt,[t("div",nt,[t("strong",null,l(o.translations.total)+":",1)]),t("div",rt,[f(t("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>v.value=e),class:"form-control",readonly:""},null,512),[[V,v.value]])])]),t("div",dt,[t("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[D(l(o.translations.save)+" Â  ",1),i.value?h("",!0):(c(),m("i",it)),i.value?(c(),m("span",ut)):h("",!0)],8,ct)])],32)])])])])])]}),_:1},8,["translations"]))}};export{_t as default};
