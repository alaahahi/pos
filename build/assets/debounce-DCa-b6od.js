import{r as V,k as E,B as h,o as X,a as x,c as Y,w as z,e as I,b as e,d as k,t as d,f as M,l as S,y as j,F as Z,g as tt,D as et,J as nt,U as w,V as at}from"./app-AYyl8aPx.js";import{_ as ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";const st={key:0,class:"modal-mask"},rt={class:"modal-wrapper"},it={class:"pos-payment-modal"},lt={class:"payment-header"},ut={class:"payment-summary"},dt={class:"summary-card"},ct={class:"summary-grid"},mt={class:"summary-item"},ft={class:"summary-value amount"},vt={key:0,class:"summary-item"},bt={class:"summary-value discount"},yt={class:"summary-item total-item"},pt={class:"summary-value final-total"},gt={class:"payment-form"},Tt={class:"form-layout"},kt={class:"form-column"},_t={class:"form-group"},$t=["max"],ht={class:"form-group"},xt={class:"form-group"},St={class:"form-label"},jt={class:"form-group"},Ot={class:"form-label"},Dt={class:"form-column"},It={class:"form-group"},wt={class:"amount-input-group"},Ct={class:"quick-amounts"},Et=["onClick"],Mt={key:0,class:"form-group"},Ft={class:"change-display"},Nt={class:"change-amount"},At={class:"payment-actions"},Vt={__name:"ModalConfirmOrderAndPay",props:{show:Boolean,total:Number,translations:Object,defaultCurrency:String},emits:["close","confirm"],setup(t,{emit:r}){const u=t;function c(){const o=new Date,n=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),T=String(o.getDate()).padStart(2,"0");return`${n}-${s}-${T}`}const a=V({date:c(),printInvoice:!1,amountDollar:u.total,discount_amount:0,discount_rate:0,notes:"",paymentMethod:"cash"}),b=V(null),m=E(()=>a.value.discount_rate>0?u.total*a.value.discount_rate/100:a.value.discount_amount||0),i=E(()=>Math.max(0,u.total-m.value)),f=E(()=>Math.max(0,a.value.amountDollar-i.value));h(()=>u.total,o=>{a.value.amountDollar=i.value}),h(()=>a.value.amountDollar,o=>{o<0&&(a.value.amountDollar=0)}),h(()=>a.value.discount_rate,o=>{o>0&&(a.value.discount_amount=0),a.value.amountDollar=i.value}),h(()=>a.value.discount_amount,o=>{o>0&&(a.value.discount_rate=0),a.value.amountDollar=i.value}),h(()=>u.show,o=>{o&&nt(()=>{var n,s;(n=b.value)==null||n.focus(),(s=b.value)==null||s.select()})});const v=()=>{a.value={date:c(),printInvoice:!1,amountDollar:i.value,discount_amount:0,discount_rate:0,notes:"",paymentMethod:"cash"}},D=()=>{a.value.amountDollar=i.value},p=o=>{a.value.amountDollar=i.value+o},_=o=>{u.show&&(o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),a.value.printInvoice=!0,g("confirm",a.value),v()),o.key==="Enter"&&o.shiftKey&&(o.preventDefault(),a.value.printInvoice=!1,g("confirm",a.value),v()),o.key==="Escape"&&(o.preventDefault(),g("close")))},g=r;return X(()=>{document.addEventListener("keydown",_)}),(o,n)=>(x(),Y(et,{name:"modal"},{default:z(()=>[t.show?(x(),I("div",st,[e("div",rt,[e("div",it,[e("div",lt,[n[10]||(n[10]=e("h4",{class:"payment-title"},[e("i",{class:"bi bi-credit-card"}),k(" إتمام عملية الدفع ")],-1)),e("button",{onClick:n[0]||(n[0]=s=>o.$emit("close")),class:"btn-close-modal"},n[9]||(n[9]=[e("i",{class:"bi bi-x"},null,-1)]))]),e("div",ut,[e("div",dt,[e("div",ct,[e("div",mt,[n[11]||(n[11]=e("div",{class:"summary-label"},"المبلغ الأصلي",-1)),e("div",ft,d(t.total.toFixed(2))+" "+d(t.defaultCurrency),1)]),m.value>0?(x(),I("div",vt,[n[12]||(n[12]=e("div",{class:"summary-label"},"الخصم",-1)),e("div",bt,"-"+d(m.value.toFixed(2))+" "+d(t.defaultCurrency),1)])):M("",!0),e("div",yt,[n[13]||(n[13]=e("div",{class:"summary-label"},"المبلغ النهائي",-1)),e("div",pt,d(i.value.toFixed(2))+" "+d(t.defaultCurrency),1)])])])]),e("div",gt,[e("div",Tt,[e("div",kt,[n[16]||(n[16]=e("div",{class:"form-group"},[e("label",{class:"form-label"},"طريقة الدفع"),e("div",{class:"payment-method-cash"},[e("div",{class:"cash-indicator"},[e("i",{class:"bi bi-cash"}),e("span",null,"نقدي")])])],-1)),e("div",_t,[n[14]||(n[14]=e("label",{class:"form-label"},"خصم مبلغ",-1)),S(e("input",{type:"number",class:"form-control","onUpdate:modelValue":n[1]||(n[1]=s=>a.value.discount_amount=s),min:"0",max:t.total,step:"0.01",placeholder:"0.00"},null,8,$t),[[j,a.value.discount_amount,void 0,{number:!0}]])]),e("div",ht,[n[15]||(n[15]=e("label",{class:"form-label"},"خصم نسبة %",-1)),S(e("input",{type:"number",class:"form-control","onUpdate:modelValue":n[2]||(n[2]=s=>a.value.discount_rate=s),min:"0",max:"100",step:"0.1",placeholder:"0"},null,512),[[j,a.value.discount_rate,void 0,{number:!0}]])]),e("div",xt,[e("label",St,d(t.translations.note),1),S(e("input",{type:"text",class:"form-control","onUpdate:modelValue":n[3]||(n[3]=s=>a.value.notes=s),placeholder:"ملاحظات إضافية..."},null,512),[[j,a.value.notes]])]),e("div",jt,[e("label",Ot,d(t.translations.date),1),S(e("input",{type:"date",class:"form-control","onUpdate:modelValue":n[4]||(n[4]=s=>a.value.date=s)},null,512),[[j,a.value.date]])])]),e("div",Dt,[e("div",It,[n[17]||(n[17]=e("label",{class:"form-label"},"المبلغ المدفوع",-1)),e("div",wt,[S(e("input",{ref_key:"amountInput",ref:b,type:"number",class:"form-control amount-input","onUpdate:modelValue":n[5]||(n[5]=s=>a.value.amountDollar=s),min:"0",step:"0.01",placeholder:"0.00"},null,512),[[j,a.value.amountDollar,void 0,{number:!0}]]),e("button",{onClick:D,class:"btn btn-outline-primary exact-btn"}," المبلغ الصحيح ")]),e("div",Ct,[(x(),I(Z,null,tt([5,10,20,50,100,200],s=>e("button",{key:s,onClick:T=>p(s),class:"btn btn-sm btn-outline-secondary quick-amount-btn"}," +"+d(s),9,Et)),64))])]),f.value>0?(x(),I("div",Mt,[e("div",Ft,[n[18]||(n[18]=e("i",{class:"bi bi-arrow-return-left"},null,-1)),n[19]||(n[19]=e("span",null,"المبلغ المرتجع: ",-1)),e("span",Nt,d(f.value.toFixed(2))+" "+d(t.defaultCurrency),1)])])):M("",!0)])])]),e("div",At,[e("button",{onClick:n[6]||(n[6]=s=>o.$emit("close")),class:"btn btn-secondary cancel-btn"},[n[20]||(n[20]=e("i",{class:"bi bi-x-circle"},null,-1)),k(" "+d(t.translations.cancel),1)]),e("button",{onClick:n[7]||(n[7]=s=>{a.value.printInvoice=!1,o.$emit("confirm",a.value),v()}),class:"btn btn-success save-btn"},[n[21]||(n[21]=e("i",{class:"bi bi-check-circle"},null,-1)),k(" "+d(t.translations.save_without_invoice),1)]),e("button",{onClick:n[8]||(n[8]=s=>{a.value.printInvoice=!0,o.$emit("confirm",a.value),v()}),class:"btn btn-primary print-btn"},[n[22]||(n[22]=e("i",{class:"bi bi-printer"},null,-1)),k(" "+d(t.translations.save_with_invoice),1)])]),n[23]||(n[23]=e("div",{class:"keyboard-info"},[e("small",{class:"text-muted"},[e("kbd",null,"Enter"),k(" حفظ وطباعة • "),e("kbd",null,"Shift+Enter"),k(" حفظ بدون طباعة • "),e("kbd",null,"Esc"),k(" إلغاء ")])],-1))])])])):M("",!0)]),_:1}))}},Le=ot(Vt,[["__scopeId","data-v-218bf819"]]);function Bt(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var W=Bt,Lt=typeof w=="object"&&w&&w.Object===Object&&w,Ut=Lt,Gt=Ut,Pt=typeof self=="object"&&self&&self.Object===Object&&self,Rt=Gt||Pt||Function("return this")(),K=Rt,Wt=K,Kt=function(){return Wt.Date.now()},qt=Kt,Ht=/\s/;function Jt(t){for(var r=t.length;r--&&Ht.test(t.charAt(r)););return r}var Qt=Jt,Xt=Qt,Yt=/^\s+/;function zt(t){return t&&t.slice(0,Xt(t)+1).replace(Yt,"")}var Zt=zt,te=K,ee=te.Symbol,q=ee,B=q,H=Object.prototype,ne=H.hasOwnProperty,ae=H.toString,O=B?B.toStringTag:void 0;function oe(t){var r=ne.call(t,O),u=t[O];try{t[O]=void 0;var c=!0}catch{}var a=ae.call(t);return c&&(r?t[O]=u:delete t[O]),a}var se=oe,re=Object.prototype,ie=re.toString;function le(t){return ie.call(t)}var ue=le,L=q,de=se,ce=ue,me="[object Null]",fe="[object Undefined]",U=L?L.toStringTag:void 0;function ve(t){return t==null?t===void 0?fe:me:U&&U in Object(t)?de(t):ce(t)}var be=ve;function ye(t){return t!=null&&typeof t=="object"}var pe=ye,ge=be,Te=pe,ke="[object Symbol]";function _e(t){return typeof t=="symbol"||Te(t)&&ge(t)==ke}var $e=_e,he=Zt,G=W,xe=$e,P=NaN,Se=/^[-+]0x[0-9a-f]+$/i,je=/^0b[01]+$/i,Oe=/^0o[0-7]+$/i,De=parseInt;function Ie(t){if(typeof t=="number")return t;if(xe(t))return P;if(G(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=G(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=he(t);var u=je.test(t);return u||Oe.test(t)?De(t.slice(2),u?2:8):Se.test(t)?P:+t}var we=Ie,Ce=W,F=qt,R=we,Ee="Expected a function",Me=Math.max,Fe=Math.min;function Ne(t,r,u){var c,a,b,m,i,f,v=0,D=!1,p=!1,_=!0;if(typeof t!="function")throw new TypeError(Ee);r=R(r)||0,Ce(u)&&(D=!!u.leading,p="maxWait"in u,b=p?Me(R(u.maxWait)||0,r):b,_="trailing"in u?!!u.trailing:_);function g(l){var y=c,$=a;return c=a=void 0,v=l,m=t.apply($,y),m}function o(l){return v=l,i=setTimeout(T,r),D?g(l):m}function n(l){var y=l-f,$=l-v,A=r-y;return p?Fe(A,b-$):A}function s(l){var y=l-f,$=l-v;return f===void 0||y>=r||y<0||p&&$>=b}function T(){var l=F();if(s(l))return N(l);i=setTimeout(T,n(l))}function N(l){return i=void 0,_&&c?g(l):(c=a=void 0,m)}function J(){i!==void 0&&clearTimeout(i),v=0,c=f=a=i=void 0}function Q(){return i===void 0?m:N(F())}function C(){var l=F(),y=s(l);if(c=arguments,a=this,f=l,y){if(i===void 0)return o(f);if(p)return clearTimeout(i),i=setTimeout(T,r),g(f)}return i===void 0&&(i=setTimeout(T,r)),m}return C.cancel=J,C.flush=Q,C}var Ae=Ne;const Ue=at(Ae);export{Le as M,Ue as d};
