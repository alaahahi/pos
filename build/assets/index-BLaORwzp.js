import{r as U,B as q,a,h as S,w as f,b as s,t as l,i as T,d as _,u as h,p as y,l as u,A as g,c as n,f as m,F as b,x as A,n as B,e as z,j as E,g as p}from"./app-DLChBEag.js";import{_ as G}from"./AuthenticatedLayout-BaBYr0b8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"pagetitle dark:text-white"},J={class:"dark:text-white"},K={class:"breadcrumb"},P={class:"breadcrumb-item"},Q={class:"breadcrumb-item active dark:text-white"},R={class:"section dashboard"},W={class:"row mb-4"},X={class:"col-xl-3 col-md-6"},Y={class:"card info-card"},Z={class:"card-body"},ss={class:"d-flex align-items-center"},ts={class:"ps-3"},es={class:"col-xl-3 col-md-6"},ls={class:"card info-card"},os={class:"card-body"},as={class:"d-flex align-items-center"},ns={class:"ps-3"},is={class:"col-xl-3 col-md-6"},ds={class:"card info-card"},rs={class:"card-body"},cs={class:"d-flex align-items-center"},us={class:"ps-3"},ms={class:"col-xl-3 col-md-6"},bs={class:"card info-card"},vs={class:"card-body"},fs={class:"d-flex align-items-center"},_s={class:"ps-3"},hs={class:"card"},ys={class:"card-header"},gs={class:"d-flex justify-content-between align-items-center"},ps={class:"card-title mb-0"},xs={class:"card-body"},ws={class:"row mb-3"},ks={class:"col-md-3"},js=["value"],Cs={class:"col-md-3"},Ls=["value"],Ms={class:"col-md-3"},Vs=["value"],Ds={class:"col-md-3"},Us={class:"table-responsive"},Ss={class:"table table-striped"},Ts={scope:"row"},As={class:"badge bg-primary"},Bs={class:"d-flex gap-1"},Hs=["onClick"],Os={class:"d-flex justify-content-center mt-3"},Fs={class:"pagination"},Ns=["innerHTML"],$s={class:"modal fade",id:"cleanLogsModal",tabindex:"-1"},qs={class:"modal-dialog"},zs={class:"modal-content"},Es={class:"modal-body"},Gs={class:"mb-3"},Is={class:"form-text"},Rs={__name:"index",props:{logs:Object,users:Array,modules:Array,actions:Array,statistics:Object,filters:Object,translations:Object},setup(o){var x,w,k,j;const v=o,r=U(30),i=U({module_name:((x=v.filters)==null?void 0:x.module_name)||"",action:((w=v.filters)==null?void 0:w.action)||"",by_user_id:((k=v.filters)==null?void 0:k.by_user_id)||"",date:((j=v.filters)==null?void 0:j.date)||""}),c=()=>{p.get(route("logs"),i.value,{preserveState:!0,replace:!0})},H=d=>d?new Date(d).toLocaleDateString("ar-SA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",O=d=>["Created","Updated","Deleted"].includes(d.action),F=d=>{confirm("هل أنت متأكد من التراجع عن هذا الإجراء؟")&&p.post(route("logs.undo",d))},N=()=>{confirm(`هل أنت متأكد من حذف السجلات الأقدم من ${r.value} يوم؟`)&&p.post(route("logs.clean"),{days:r.value})};return q(i,()=>{c()},{deep:!0}),(d,t)=>(a(),S(G,{translations:o.translations},{default:f(()=>{var C,L,M,V;return[s("div",I,[s("h1",J,l(o.translations.logs),1),s("nav",null,[s("ol",K,[s("li",P,[T(h(y),{class:"nav-link dark:text-white",href:d.route("dashboard")},{default:f(()=>[_(l(o.translations.Home),1)]),_:1},8,["href"])]),s("li",Q,l(o.translations.logs),1)])])]),s("section",R,[s("div",W,[s("div",X,[s("div",Y,[s("div",Z,[t[6]||(t[6]=s("h5",{class:"card-title"},"إجمالي السجلات",-1)),s("div",ss,[t[5]||(t[5]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-journal-text"})],-1)),s("div",ts,[s("h6",null,l(((C=o.statistics)==null?void 0:C.total)||0),1)])])])])]),s("div",es,[s("div",ls,[s("div",os,[t[8]||(t[8]=s("h5",{class:"card-title"},"اليوم",-1)),s("div",as,[t[7]||(t[7]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-calendar-day"})],-1)),s("div",ns,[s("h6",null,l(((L=o.statistics)==null?void 0:L.today)||0),1)])])])])]),s("div",is,[s("div",ds,[s("div",rs,[t[10]||(t[10]=s("h5",{class:"card-title"},"هذا الأسبوع",-1)),s("div",cs,[t[9]||(t[9]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-calendar-week"})],-1)),s("div",us,[s("h6",null,l(((M=o.statistics)==null?void 0:M.this_week)||0),1)])])])])]),s("div",ms,[s("div",bs,[s("div",vs,[t[12]||(t[12]=s("h5",{class:"card-title"},"هذا الشهر",-1)),s("div",fs,[t[11]||(t[11]=s("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[s("i",{class:"bi bi-calendar-month"})],-1)),s("div",_s,[s("h6",null,l(((V=o.statistics)==null?void 0:V.this_month)||0),1)])])])])])]),s("div",hs,[s("div",ys,[s("div",gs,[s("h5",ps,[t[13]||(t[13]=s("i",{class:"bi bi-journal-text me-2"},null,-1)),_(" "+l(o.translations.logs),1)]),t[14]||(t[14]=s("div",{class:"d-flex gap-2"},[s("button",{type:"button",class:"btn btn-warning btn-sm","data-bs-toggle":"modal","data-bs-target":"#cleanLogsModal"},[s("i",{class:"bi bi-trash me-1"}),_(" تنظيف السجلات القديمة ")])],-1))])]),s("div",xs,[s("div",ws,[s("div",ks,[t[16]||(t[16]=s("label",{class:"form-label"},"الوحدة",-1)),u(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.value.module_name=e),onChange:c,class:"form-select"},[t[15]||(t[15]=s("option",{value:""},"جميع الوحدات",-1)),(a(!0),n(b,null,m(o.modules,e=>(a(),n("option",{key:e,value:e},l(e),9,js))),128))],544),[[g,i.value.module_name]])]),s("div",Cs,[t[18]||(t[18]=s("label",{class:"form-label"},"العملية",-1)),u(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.value.action=e),onChange:c,class:"form-select"},[t[17]||(t[17]=s("option",{value:""},"جميع العمليات",-1)),(a(!0),n(b,null,m(o.actions,e=>(a(),n("option",{key:e,value:e},l(e),9,Ls))),128))],544),[[g,i.value.action]])]),s("div",Ms,[t[20]||(t[20]=s("label",{class:"form-label"},"المستخدم",-1)),u(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.value.by_user_id=e),onChange:c,class:"form-select"},[t[19]||(t[19]=s("option",{value:""},"جميع المستخدمين",-1)),(a(!0),n(b,null,m(o.users,e=>(a(),n("option",{key:e.id,value:e.id},l(e.name),9,Vs))),128))],544),[[g,i.value.by_user_id]])]),s("div",Ds,[t[21]||(t[21]=s("label",{class:"form-label"},"التاريخ",-1)),u(s("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=e=>i.value.date=e),onChange:c,class:"form-control"},null,544),[[A,i.value.date]])])]),s("div",Us,[s("table",Ss,[t[24]||(t[24]=s("thead",null,[s("tr",null,[s("th",{scope:"col"},"#"),s("th",{scope:"col"},"المستخدم"),s("th",{scope:"col"},"الوحدة"),s("th",{scope:"col"},"العملية"),s("th",{scope:"col"},"معرف السجل"),s("th",{scope:"col"},"التاريخ"),s("th",{scope:"col"},"الإجراءات")])],-1)),s("tbody",null,[(a(!0),n(b,null,m(o.logs.data,(e,$)=>{var D;return a(),n("tr",{key:e.id},[s("th",Ts,l($+1),1),s("td",null,l(((D=e.user)==null?void 0:D.name)||"غير محدد"),1),s("td",null,[s("span",As,l(e.module_name),1)]),s("td",null,[s("span",{class:B(["badge","bg-"+e.badge])},l(e.action),3)]),s("td",null,l(e.affected_record_id),1),s("td",null,l(H(e.created_at)),1),s("td",null,[s("div",Bs,[T(h(y),{href:d.route("logs.view",e.id),class:"btn btn-sm btn-outline-primary"},{default:f(()=>t[22]||(t[22]=[s("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),O(e)?(a(),n("button",{key:0,onClick:Js=>F(e.id),class:"btn btn-sm btn-outline-warning"},t[23]||(t[23]=[s("i",{class:"bi bi-arrow-counterclockwise"},null,-1)]),8,Hs)):z("",!0)])])])}),128))])])]),s("div",Os,[s("nav",null,[s("ul",Fs,[(a(!0),n(b,null,m(o.logs.links,e=>(a(),n("li",{key:e.label,class:B(["page-item",{active:e.active,disabled:!e.url}])},[e.url?(a(),S(h(y),{key:0,href:e.url,class:"page-link",innerHTML:e.label},null,8,["href","innerHTML"])):(a(),n("span",{key:1,class:"page-link",innerHTML:e.label},null,8,Ns))],2))),128))])])])])])]),s("div",$s,[s("div",qs,[s("div",zs,[t[27]||(t[27]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title"},"تنظيف السجلات القديمة"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),s("form",{onSubmit:E(N,["prevent"])},[s("div",Es,[s("div",Gs,[t[25]||(t[25]=s("label",{class:"form-label"},"حذف السجلات الأقدم من (أيام)",-1)),u(s("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>r.value=e),class:"form-control",min:"1",max:"365",required:""},null,512),[[A,r.value]]),s("div",Is," سيتم حذف جميع السجلات الأقدم من "+l(r.value)+" يوم ",1)])]),t[26]||(t[26]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"إلغاء"),s("button",{type:"submit",class:"btn btn-warning"},"تنظيف")],-1))],32)])])])]}),_:1},8,["translations"]))}};export{Rs as default};
