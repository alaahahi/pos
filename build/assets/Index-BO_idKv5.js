import{s as O,z,g as V,a as u,h as q,w as v,b as t,i as _,d,t as n,u as h,p as y,l as w,x as k,A as G,c as f,f as U,F as Y,e as H}from"./app-DLChBEag.js";import{_ as J}from"./AuthenticatedLayout-BaBYr0b8.js";import{_ as K}from"./Pagination-CFIkyltx.js";import{l as P}from"./lodash-BvrqNJEK.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={dir:"rtl",lang:"ar"},W={class:"pagetitle dark:text-white"},X={class:"breadcrumb"},Z={class:"breadcrumb-item"},tt={class:"section dashboard"},st={class:"row mb-4"},et={class:"col-xl-3 col-md-6"},lt={class:"card info-card sales-card"},nt={class:"card-body"},ot={class:"d-flex align-items-center"},it={class:"ps-3"},at={class:"col-xl-3 col-md-6"},rt={class:"card info-card revenue-card"},dt={class:"card-body"},ct={class:"d-flex align-items-center"},ut={class:"ps-3"},pt={class:"col-xl-3 col-md-6"},mt={class:"card info-card customers-card"},bt={class:"card-body"},ht={class:"d-flex align-items-center"},ft={class:"ps-3"},vt={class:"col-xl-3 col-md-6"},_t={class:"card info-card revenue-card"},gt={class:"card-body"},xt={class:"d-flex align-items-center"},yt={class:"ps-3"},wt={class:"card"},kt={class:"card-header d-flex justify-content-between align-items-center"},It={class:"d-flex gap-2"},Dt={class:"card-body"},Mt={class:"row mb-4"},St={class:"col-md-4"},Ft={class:"search-box"},Ct={class:"col-md-2"},jt=["value"],Vt={class:"col-md-2"},Ut={class:"col-md-2"},Yt={class:"table-responsive"},Lt={class:"table table-hover"},Tt={class:"invoice-number"},At={key:0,class:"supplier-info"},Bt={class:"text-muted"},Nt={key:1,class:"text-muted"},$t={class:"date-text"},Et={class:"badge bg-info"},Ot={class:"amount-info"},zt={class:"text-success"},qt={class:"creator-info"},Gt={class:"date-text"},Ht={class:"action-buttons"},Jt={class:"btn-group",role:"group"},Kt=["onClick"],Pt={key:0,class:"text-center py-5"},Qt={__name:"Index",props:{purchaseInvoices:Object,suppliers:Array,filters:Object,translations:Object},setup(c){var M,S,F,C;const i=c,I=O(),o=z({search:((M=i.filters)==null?void 0:M.search)||"",supplier_id:((S=i.filters)==null?void 0:S.supplier_id)||"",date_from:((F=i.filters)==null?void 0:F.date_from)||"",date_to:((C=i.filters)==null?void 0:C.date_to)||""}),D=P.debounce(()=>{g()},500),g=()=>{V.get(route("purchase-invoices.index"),o,{preserveState:!0,replace:!0})},L=()=>{o.search="",o.supplier_id="",o.date_from="",o.date_to="",g()},T=l=>l?new Date(l).toLocaleDateString("en-US"):"-",A=l=>l?new Date(l).toLocaleString("en-US"):"-",B=()=>{var m;if(!((m=i.purchaseInvoices)!=null&&m.data))return"0";const l=new Date().getMonth(),s=new Date().getFullYear(),x=i.purchaseInvoices.data.filter(r=>{const a=new Date(r.invoice_date);return a.getMonth()===l&&a.getFullYear()===s}).reduce((r,a)=>r+parseFloat(a.total_amount),0);return Math.round(x).toLocaleString()},N=()=>i.suppliers?i.suppliers.length:0,$=()=>{var r,a;if(!((a=(r=i.purchaseInvoices)==null?void 0:r.data)!=null&&a.length))return"0";const l=new Date().getMonth(),s=new Date().getFullYear(),p=i.purchaseInvoices.data.filter(e=>{const b=new Date(e.invoice_date);return b.getMonth()===l&&b.getFullYear()===s});if(!p.length)return"0";const m=p.reduce((e,b)=>e+parseFloat(b.total_amount),0)/p.length;return Math.round(m).toLocaleString()},E=l=>{confirm(`هل أنت متأكد من حذف فاتورة المشتريات رقم ${l.invoice_number}؟`)&&V.delete(route("purchase-invoices.destroy",l.id),{onSuccess:()=>{I.success("تم حذف فاتورة المشتريات بنجاح")},onError:()=>{I.error("حدث خطأ أثناء حذف فاتورة المشتريات")}})};return(l,s)=>(u(),q(J,{translations:c.translations},{default:v(()=>{var p,x,m,r,a;return[t("div",R,[t("div",W,[s[6]||(s[6]=t("h1",{class:"dark:text-white"},"فواتير المشتريات",-1)),t("nav",null,[t("ol",X,[t("li",Z,[_(h(y),{class:"nav-link dark:text-white",href:l.route("dashboard")},{default:v(()=>[d(n(c.translations.home),1)]),_:1},8,["href"])]),s[5]||(s[5]=t("li",{class:"breadcrumb-item active dark:text-white"},"فواتير المشتريات",-1))])])]),t("section",tt,[t("div",st,[t("div",et,[t("div",lt,[t("div",nt,[s[9]||(s[9]=t("h5",{class:"card-title"},[d("إجمالي الفواتير "),t("span",null,"| جميع الفواتير")],-1)),t("div",ot,[s[8]||(s[8]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-receipt"})],-1)),t("div",it,[t("h6",null,n(((p=c.purchaseInvoices)==null?void 0:p.total)||0),1),s[7]||(s[7]=t("span",{class:"text-success small pt-1 fw-bold"},"فاتورة",-1))])])])])]),t("div",at,[t("div",rt,[t("div",dt,[s[12]||(s[12]=t("h5",{class:"card-title"},[d("إجمالي المشتريات "),t("span",null,"| هذا الشهر")],-1)),t("div",ct,[s[11]||(s[11]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-currency-dollar"})],-1)),t("div",ut,[t("h6",null,n(B()),1),s[10]||(s[10]=t("span",{class:"text-primary small pt-1 fw-bold"},"دينار",-1))])])])])]),t("div",pt,[t("div",mt,[t("div",bt,[s[15]||(s[15]=t("h5",{class:"card-title"},[d("عدد الموردين "),t("span",null,"| نشط")],-1)),t("div",ht,[s[14]||(s[14]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-people"})],-1)),t("div",ft,[t("h6",null,n(N()),1),s[13]||(s[13]=t("span",{class:"text-success small pt-1 fw-bold"},"مورد",-1))])])])])]),t("div",vt,[t("div",_t,[t("div",gt,[s[18]||(s[18]=t("h5",{class:"card-title"},[d("متوسط الفاتورة "),t("span",null,"| هذا الشهر")],-1)),t("div",xt,[s[17]||(s[17]=t("div",{class:"card-icon rounded-circle d-flex align-items-center justify-content-center"},[t("i",{class:"bi bi-graph-up"})],-1)),t("div",yt,[t("h6",null,n($()),1),s[16]||(s[16]=t("span",{class:"text-info small pt-1 fw-bold"},"دينار",-1))])])])])])]),t("div",wt,[t("div",kt,[s[20]||(s[20]=t("h5",{class:"card-title mb-0"},[t("i",{class:"bi bi-receipt me-2"}),d(" إدارة فواتير المشتريات ")],-1)),t("div",It,[_(h(y),{href:l.route("purchase-invoices.create"),class:"btn btn-primary"},{default:v(()=>s[19]||(s[19]=[t("i",{class:"bi bi-plus-circle"},null,-1),d(" إنشاء فاتورة جديدة ")])),_:1},8,["href"])])]),t("div",Dt,[t("div",Mt,[t("div",St,[t("div",Ft,[w(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=e=>o.search=e),placeholder:"ابحث برقم الفاتورة أو المورد...",onInput:s[1]||(s[1]=(...e)=>h(D)&&h(D)(...e))},null,544),[[k,o.search]]),s[21]||(s[21]=t("i",{class:"bi bi-search search-icon"},null,-1))])]),t("div",Ct,[w(t("select",{class:"form-select","onUpdate:modelValue":s[2]||(s[2]=e=>o.supplier_id=e),onChange:g},[s[22]||(s[22]=t("option",{value:""},"جميع الموردين",-1)),(u(!0),f(Y,null,U(c.suppliers,e=>(u(),f("option",{key:e.id,value:e.id},n(e.name),9,jt))),128))],544),[[G,o.supplier_id]])]),t("div",Vt,[w(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=e=>o.date_from=e),onChange:g,placeholder:"من تاريخ"},null,544),[[k,o.date_from]])]),t("div",Ut,[w(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=e=>o.date_to=e),onChange:g,placeholder:"إلى تاريخ"},null,544),[[k,o.date_to]])]),t("div",{class:"col-md-2"},[t("button",{class:"btn btn-outline-secondary w-100",onClick:L},s[23]||(s[23]=[t("i",{class:"bi bi-arrow-clockwise"},null,-1),d(" مسح الفلاتر ")]))])]),t("div",Yt,[t("table",Lt,[s[28]||(s[28]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"رقم الفاتورة"),t("th",null,"المورد"),t("th",null,"تاريخ الفاتورة"),t("th",null,"عدد المنتجات"),t("th",null,"المبلغ الإجمالي"),t("th",null,"أنشأ بواسطة"),t("th",null,"تاريخ الإنشاء"),t("th",{class:"text-center"},"الإجراءات")])],-1)),t("tbody",null,[(u(!0),f(Y,null,U((x=c.purchaseInvoices)==null?void 0:x.data,e=>{var b,j;return u(),f("tr",{key:e.id,class:"invoice-row"},[t("td",null,[t("div",Tt,[t("strong",null,n(e.invoice_number),1)])]),t("td",null,[e.supplier?(u(),f("div",At,[t("strong",null,n(e.supplier.name),1),s[24]||(s[24]=t("br",null,null,-1)),t("small",Bt,n(e.supplier.phone),1)])):(u(),f("span",Nt,"غير محدد"))]),t("td",null,[t("span",$t,n(T(e.invoice_date)),1)]),t("td",null,[t("span",Et,n(((b=e.items)==null?void 0:b.length)||0)+" منتج",1)]),t("td",null,[t("div",Ot,[t("strong",zt,n(Math.round(e.total_amount))+" دينار",1)])]),t("td",null,[t("div",qt,[t("strong",null,n((j=e.creator)==null?void 0:j.name),1)])]),t("td",null,[t("span",Gt,n(A(e.created_at)),1)]),t("td",null,[t("div",Ht,[t("div",Jt,[_(h(y),{href:l.route("purchase-invoices.show",e.id),class:"btn btn-sm btn-outline-primary",title:"عرض التفاصيل"},{default:v(()=>s[25]||(s[25]=[t("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),_(h(y),{href:l.route("purchase-invoices.edit",e.id),class:"btn btn-sm btn-outline-warning",title:"تعديل"},{default:v(()=>s[26]||(s[26]=[t("i",{class:"bi bi-pencil"},null,-1)])),_:2},1032,["href"]),t("button",{onClick:Rt=>E(e),class:"btn btn-sm btn-outline-danger",title:"حذف"},s[27]||(s[27]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Kt)])])])])}),128))])])]),(r=(m=c.purchaseInvoices)==null?void 0:m.data)!=null&&r.length?H("",!0):(u(),f("div",Pt,[s[30]||(s[30]=t("i",{class:"bi bi-receipt display-1 text-muted"},null,-1)),s[31]||(s[31]=t("h5",{class:"text-muted mt-3"},"لا توجد فواتير مشتريات",-1)),s[32]||(s[32]=t("p",{class:"text-muted"},"ابدأ بإنشاء فاتورة مشتريات جديدة",-1)),_(h(y),{href:l.route("purchase-invoices.create"),class:"btn btn-primary"},{default:v(()=>s[29]||(s[29]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),d(" إنشاء فاتورة جديدة ")])),_:1},8,["href"])]))])]),_(K,{links:(a=c.purchaseInvoices)==null?void 0:a.links},null,8,["links"])])])]}),_:1},8,["translations"]))}},es=Q(Qt,[["__scopeId","data-v-36230384"]]);export{es as default};
