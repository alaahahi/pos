import{r as V,T as S,x as q,k as T,B as j,C as A,a as c,h as E,w as C,b as t,t as l,i as _,d as g,j as L,u as f,c as u,F as D,f as F,l as y,y as k,e as p}from"./app-DMyzD3gI.js";import{_ as O}from"./AuthenticatedLayout-CWYmhCfZ.js";import{_ as H}from"./InputError-DATqMiZx.js";import{C as U}from"./vue-select-6BHZhAxH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"pagetitle dark:text-white"},z={class:"dark:text-white"},G={class:"breadcrumb"},J={class:"breadcrumb-item"},K={class:"breadcrumb-item active dark:text-white"},R={class:"section dashboard"},W={class:"row"},X={class:"col-lg-12"},Y={class:"card"},Z={class:"card-body"},tt={class:"card-title"},et={class:"row mb-3"},st={for:"customerSelect",class:"col-sm-2 col-form-label"},ot={class:"col-sm-10"},at={key:0,class:"row mb-3"},lt={for:"productTable",class:"col-sm-2 col-form-label"},nt={class:"col-sm-10"},rt={class:"table"},dt=["onInput","onUpdate:modelValue","max"],ct=["onUpdate:modelValue"],it=["value"],ut=["onClick"],mt={class:"row"},ht={class:"col-md-6"},bt={class:"col-md-6"},_t={class:"text-center"},pt=["disabled"],vt={key:0,class:"bi bi-save"},ft={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},qt={__name:"Edit",props:{order:Object,products:Array,customers:Array,translations:Object},setup(e){const i=V(!1),r=e,m=V(r.customers.find(s=>s.id===r.order.customer_id)||null),d=S({id:r.order.id,customer_id:r.order.customer_id,items:r.order.items||[],total_amount:r.order.total_amount||0}),h=q(d.items);q([]);const M=s=>{const a=r.products.find(b=>b.id===s.product_id);a&&(s.price=a.price)},$=s=>{const a=r.products.find(b=>b.id===s.product_id);a&&s.quantity>a.max_quantity&&(s.quantity=a.max_quantity)},v=T(()=>h.reduce((s,a)=>s+a.quantity*a.price,0));j(v,s=>{d.total_amount=s});const B=()=>{h.push({product_id:"",quantity:1,price:0,canadd:"true"})},I=s=>{h.splice(s,1)},P=s=>{m.value=s,d.customer_id=s?s.id:null},N=()=>{i.value=!0,d.items=h,d.put(route("orders.update",d.id),{onSuccess:()=>{i.value=!1},onError:()=>{i.value=!1}})};return(s,a)=>{const b=A("Link");return c(),E(O,{translations:e.translations},{default:C(()=>{var w;return[t("div",Q,[t("h1",z,l(e.translations.edit_order),1),t("nav",null,[t("ol",G,[t("li",J,[_(b,{class:"nav-link dark:text-white",href:s.route("dashboard")},{default:C(()=>[g(l(e.translations.Home),1)]),_:1},8,["href"])]),t("li",K,l(e.translations.edit_order),1)])])]),t("section",R,[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("h5",tt,l(e.translations.edit_order),1),t("form",{onSubmit:L(N,["prevent"]),class:"row g-3"},[t("div",et,[t("label",st,l(e.translations.client),1),t("div",ot,[_(f(U),{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=o=>m.value=o),options:e.customers,label:"name","track-by":"id",reduce:o=>({id:o.id,name:o.name}),clearable:!0,placeholder:e.translations.select_customer,onMouseleave:a[1]||(a[1]=o=>P(m.value))},null,8,["modelValue","options","reduce","placeholder"]),_(H,{message:f(d).errors.customer},null,8,["message"])])]),m.value?(c(),u("div",at,[t("label",lt,l(e.translations.products),1),t("div",nt,[t("table",rt,[t("thead",null,[t("tr",null,[t("th",null,l(e.translations.product),1),t("th",null,l(e.translations.quantity),1),t("th",null,l(e.translations.price),1),t("th",null,l(e.translations.total),1),t("th",null,l(e.translations.actions),1)])]),t("tbody",null,[(c(!0),u(D,null,F(h,(o,x)=>(c(),u("tr",{key:x},[_(f(U),{modelValue:o.product_id,"onUpdate:modelValue":n=>o.product_id=n,options:e.products,label:"name",disabled:o.canadd!="true",reduce:n=>n.id,placeholder:e.translations.select_product,class:"form-control",style:{"min-width":"200px"},onMouseleave:n=>M(o)},null,8,["modelValue","onUpdate:modelValue","options","disabled","reduce","placeholder","onMouseleave"]),t("td",null,[y(t("input",{type:"number",onInput:n=>$(o),"onUpdate:modelValue":n=>o.quantity=n,min:"1",max:o.max_quantity,class:"form-control",placeholder:"Quantity"},null,40,dt),[[k,o.quantity]])]),t("td",null,[y(t("input",{type:"number","onUpdate:modelValue":n=>o.price=n,min:"0",class:"form-control",placeholder:"Price"},null,8,ct),[[k,o.price]])]),t("td",null,[t("input",{type:"number",value:o.quantity*o.price,class:"form-control",disabled:""},null,8,it)]),t("td",null,[t("button",{type:"button",class:"btn btn-danger",onClick:n=>I(x)},a[3]||(a[3]=[t("i",{class:"bi bi-trash"},null,-1)]),8,ut)])]))),128))])]),(w=e.products)!=null&&w.length?(c(),u("button",{key:0,type:"button",class:"btn btn-primary",onClick:B},l(e.translations.add_product),1)):p("",!0)])])):p("",!0),t("div",mt,[t("div",ht,[t("strong",null,l(e.translations.total)+":",1)]),t("div",bt,[y(t("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=o=>v.value=o),class:"form-control",readonly:""},null,512),[[k,v.value]])])]),t("div",_t,[t("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[g(l(e.translations.save)+" Â  ",1),i.value?p("",!0):(c(),u("i",vt)),i.value?(c(),u("span",ft)):p("",!0)],8,pt)])],32)])])])])])]}),_:1},8,["translations"])}}};export{qt as default};
