# 🧪 تعليمات الاختبار - نظام فواتير المشتريات

## ⚡ الاختبار السريع (10 ثواني)

### الطريقة 1: تشغيل الاختبار التلقائي

افتح **Command Prompt** (وليس PowerShell) واكتب:

```cmd
php test-purchase-system.php
```

**أو** استخدم الملف الجاهز:

```cmd
run-test-purchase.bat
```

### النتيجة المتوقعة:
```
✅ نجح: 10
❌ فشل: 0
📈 معدل النجاح: 100%

🎉 جميع الاختبارات نجحت!
```

---

## 🖱️ الاختبار اليدوي (5 دقائق)

### الخطوة 1: صفحة الموردين
```
1. افتح: http://127.0.0.1:8000/suppliers
2. تحقق من:
   ✓ الصفحة تفتح بدون أخطاء
   ✓ العرض من اليمين لليسار (RTL)
   ✓ يمكنك البحث عن مورد
```

### الخطوة 2: صفحة فواتير المشتريات
```
1. افتح: http://127.0.0.1:8000/purchase-invoices
2. تحقق من:
   ✓ 4 بطاقات إحصائية تظهر
   ✓ جدول الفواتير يعرض البيانات
   ✓ زر "إنشاء فاتورة جديدة" موجود
```

### الخطوة 3: إنشاء فاتورة مشتريات
```
1. افتح: http://127.0.0.1:8000/purchase-invoices/create
2. اختبر:
   
   أ. اختيار المورد:
   ✓ ابحث عن مورد موجود
   ✓ اختر مورد من القائمة
   
   ب. إضافة منتجات:
   ✓ ابحث عن منتج بالاسم
   ✓ أو ابحث بالباركود
   ✓ اضغط على المنتج لإضافته
   ✓ يجب أن يظهر في الجدول
   
   ج. تحديد التفاصيل:
   ✓ غيّر الكمية
   ✓ غيّر سعر التكلفة
   ✓ غيّر سعر البيع
   ✓ المجموع يحسب تلقائياً
   
   د. خيار السحب من الصندوق:
   ✓ فعّل "☑ سحب من الصندوق"
   ✓ يجب أن ترى تنبيه: "سيتم سحب XXX من الصندوق"
```

### الخطوة 4: حفظ واختبار النتيجة

#### قبل الحفظ - سجل البيانات:
```
□ اسم المنتج: _________________
□ الكمية الحالية: _____________
□ السعر الحالي: ______________
□ رصيد الصندوق: ______________
```

#### احفظ الفاتورة:
```
1. اضغط "حفظ الفاتورة"
2. انتظر رسالة "تم إنشاء فاتورة المشتريات بنجاح"
3. يجب أن يتم تحويلك لصفحة الفواتير
```

#### بعد الحفظ - تحقق من:

**أ. المنتج:**
```
1. افتح: http://127.0.0.1:8000/products
2. ابحث عن المنتج
3. تحقق من:
   ✓ الكمية زادت؟ (القديم + الجديد = المجموع)
   ✓ السعر تحدث؟ (أصبح سعر البيع الجديد)
```

**ب. الصندوق (إذا فعّلت السحب):**
```
1. افتح: http://127.0.0.1:8000/boxes
2. تحقق من:
   ✓ معاملة سحب جديدة ظاهرة
   ✓ البيان: "شراء منتجات - فاتورة رقم: PIXXXXXX"
   ✓ المبلغ: نفس مجموع الفاتورة
   ✓ الرصيد نقص بقيمة الفاتورة
```

**ج. الفاتورة:**
```
1. افتح: http://127.0.0.1:8000/purchase-invoices
2. تحقق من:
   ✓ الفاتورة الجديدة ظاهرة في أول القائمة
   ✓ المورد صحيح
   ✓ المبلغ صحيح
   ✓ عدد المنتجات صحيح
```

---

## 📋 قائمة التحقق الشاملة

### ✅ الوظائف:
- [ ] صفحة الموردين تعمل
- [ ] صفحة فواتير المشتريات تعمل
- [ ] صفحة إنشاء فاتورة تعمل
- [ ] البحث عن المورد يعمل
- [ ] البحث عن المنتجات يعمل
- [ ] إضافة منتجات للفاتورة يعمل
- [ ] حساب المجموع تلقائي يعمل
- [ ] خيار "سحب من الصندوق" يعمل
- [ ] حفظ الفاتورة يعمل
- [ ] زيادة الكميات تلقائياً يعمل
- [ ] تحديث الأسعار تلقائياً يعمل
- [ ] السحب من الصندوق يعمل (إن فُعّل)

### ✅ التصميم:
- [ ] RTL مطبق في جميع الصفحات
- [ ] الأسعار بدون فواصل عشرية
- [ ] البطاقات الإحصائية تعرض بشكل صحيح
- [ ] الجداول واضحة ومنظمة
- [ ] الأزرار تعمل بشكل صحيح
- [ ] Loading states تظهر عند الانتظار

---

## 🎯 مثال اختبار كامل

### السيناريو:
```
المورد: شركة المنظفات
المنتج: شامبو
الكمية الحالية: 50
السعر الحالي: 6000 IQD
رصيد الصندوق: 10,000,000 IQD
```

### الفاتورة:
```
الكمية المشتراة: 100
سعر التكلفة: 5000
سعر البيع الجديد: 7000
المجموع: 500,000 IQD
☑ سحب من الصندوق
```

### النتيجة المتوقعة:
```
✓ الكمية: 150 (50 + 100)
✓ السعر: 7000 (محدث)
✓ رصيد الصندوق: 9,500,000 (10M - 500K)
✓ معاملة سحب في صفحة الصندوق
```

---

## ❌ الأخطاء الشائعة

### إذا لم تزد الكميات:
```
⚠️ تحقق من:
1. هل تم حفظ الفاتورة بنجاح؟
2. هل تم اختيار المنتج الصحيح؟
3. تحقق من logs في console
```

### إذا لم تتحدث الأسعار:
```
⚠️ تحقق من:
1. هل حددت سعر بيع جديد؟
2. هل السعر الجديد مختلف عن القديم؟
```

### إذا لم يُسحب من الصندوق:
```
⚠️ تحقق من:
1. هل فعّلت الخيار "☑ سحب من الصندوق"؟
2. هل الصندوق الرئيسي موجود؟
3. تحقق من صفحة الصندوق
```

---

## 🎊 النتيجة

إذا نجحت جميع الاختبارات:

```
╔════════════════════════════════════════╗
║                                        ║
║   ✅ النظام يعمل بشكل مثالي! ✅      ║
║                                        ║
║   جميع المميزات تعمل:                ║
║   ✓ زيادة الكميات                   ║
║   ✓ تحديث الأسعار                    ║
║   ✓ سحب من الصندوق                  ║
║   ✓ RTL مطبق                         ║
║   ✓ بدون فواصل عشرية                ║
║                                        ║
║   🚀 جاهز للاستخدام! 🚀             ║
║                                        ║
╚════════════════════════════════════════╝
```

---

## 📞 المساعدة

### إذا واجهت مشاكل:

1. **افتح Console في المتصفح** (F12)
   - ابحث عن أخطاء JavaScript
   - ابحث عن أخطاء API

2. **تحقق من logs لارافيل**
   - افتح: `storage/logs/laravel.log`
   - ابحث عن أخطاء PHP

3. **تحقق من قاعدة البيانات**
   - افتح phpMyAdmin
   - تحقق من جدول `purchase_invoices`
   - تحقق من جدول `products`

---

## 🎯 الروابط السريعة

| الصفحة | الرابط |
|--------|--------|
| الموردين | http://127.0.0.1:8000/suppliers |
| فواتير المشتريات | http://127.0.0.1:8000/purchase-invoices |
| إنشاء فاتورة | http://127.0.0.1:8000/purchase-invoices/create |
| الصندوق | http://127.0.0.1:8000/boxes |
| المنتجات | http://127.0.0.1:8000/products |

---

**📅 التاريخ:** 2025-10-17  
**✅ الحالة:** جاهز للاختبار  
**⏱️ الوقت المتوقع:** 5 دقائق

