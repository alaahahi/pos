# ๐ ุฏููู ูุธุงู ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ - Offline First

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงููุธุงู ูุณูุญ ููุชุทุจูู ุจุงูุนูู **offline** ุจุงููุงููุ ูุน ูุฒุงููุฉ ุชููุงุฆูุฉ ูู 5 ุฏูุงุฆู ุนูุฏ ุชููุฑ ุงูุฅูุชุฑูุช.

---

## โจ ุงููููุฒุงุช

- โ **Offline First**: ุงูุชุทุจูู ูุนูู ุญุชู ุจุฏูู ุฅูุชุฑูุช
- โ **ูุฒุงููุฉ ุชููุงุฆูุฉ**: ูู 5 ุฏูุงุฆู (ูุงุจู ููุชุฎุตูุต)
- โ **Service Worker**: ุฏุนู PWA ููุงุด ุฐูู
- โ **Background Sync**: ูุฒุงููุฉ ูู ุงูุฎูููุฉ ุนูุฏ ุนูุฏุฉ ุงูุฅูุชุฑูุช
- โ **ูุญุต ุณุฑูุน**: API ูุง ูุชุทูุจ ุงุชุตุงู ุจุงูุณูุฑูุฑ

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช (.env)

```env
# ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
AUTO_SYNC_ENABLED=true
AUTO_SYNC_INTERVAL=300  # ุจุงูุซูุงูู (300 = 5 ุฏูุงุฆู)

# ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ (SQLite)
SYNC_LOCAL_CONNECTION=sync_sqlite
SYNC_SQLITE_PATH=C:\xampp\htdocs\pos\database\sync.sqlite

# ุงูุณูุฑูุฑ ุงูุจุนูุฏ (ุงุฎุชูุงุฑู ููู offline mode)
ONLINE_URL=https://your-server.com
SYNC_API_TOKEN=your_token_here
SYNC_VIA_API=true

# ูุถุน ุงูุชุทุจูู
APP_ENV=production  # ููู: ูุฌุจ ุฃู ูููู production ูุงุณุชุฎุฏุงู MySQL
```

---

## ๐ ุทุฑู ุชุดุบูู ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ

### 1๏ธโฃ **ุจุงุณุชุฎุฏุงู Batch File (ุฃุณูู ุทุฑููุฉ)**

ุดุบูู ุงูููู:
```batch
start-auto-sync.bat
```

ูุฐุง ุณูุดุบู ุงููุฒุงููุฉ ูู 5 ุฏูุงุฆู. ุงุชุฑู ุงููุงูุฐุฉ ููุชูุญุฉ.

---

### 2๏ธโฃ **ุจุงุณุชุฎุฏุงู Laravel Scheduler (ุงูุฃูุถู ููุฅูุชุงุฌ)**

ุดุบูู ุงูู scheduler:
```batch
php artisan schedule:work
```

ุฃู ุฃุถูู ูู Task Scheduler ูู Windows:
1. ุงูุชุญ **Task Scheduler**
2. **Create Basic Task...**
3. ุงูุงุณู: `POS Auto Sync`
4. Trigger: **When the computer starts**
5. Action: **Start a program**
   - Program: `C:\xampp\php\php.exe`
   - Arguments: `artisan schedule:work`
   - Start in: `C:\xampp\htdocs\pos`

---

### 3๏ธโฃ **ูุฒุงููุฉ ูุฏููุฉ (ูู ุงููุงุฌูุฉ)**

1. ุงุฐูุจ ุฅูู: `/sync-monitor`
2. ุงุถุบุท ุนูู: **๐ ูุญุต ุงูุงุชุตุงู**
3. ุฅุฐุง ูุงู ุงูุณูุฑูุฑ ูุชุงุญุ ุงุถุบุท: **๐ฅ ูุฒุงููุฉ ูู ุงูุณูุฑูุฑ**

---

### 4๏ธโฃ **ูุฒุงููุฉ ูุฏููุฉ (ูู Terminal)**

```batch
# ูุฒุงููุฉ ุนุงุฏูุฉ (ุชุญุชุฑู ุงููุคูุช)
php artisan sync:auto

# ูุฑุถ ุงููุฒุงููุฉ ุงูุขู (ุชุฌุงูุฒ ุงููุคูุช)
php artisan sync:auto --force
```

---

## ๐ ูุญุต ุญุงูุฉ ุงููุธุงู

### ูู ุงููุงุฌูุฉ:
```
http://127.0.0.1:8000/sync-monitor
```

ุงุถุบุท ุนูู **๐ ูุญุต ุงูุงุชุตุงู** ููุนุฑูุฉ:
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ
- โ ุญุงูุฉ ุงูุฅูุชุฑูุช
- โ ุญุงูุฉ ุงูุณูุฑูุฑ ุงูุจุนูุฏ
- โ ููุช ุขุฎุฑ ูุฒุงููุฉ

### ูู API:
```batch
curl http://127.0.0.1:8000/api/sync-monitor/check-health
```

ุงูุงุณุชุฌุงุจุฉ:
```json
{
  "success": true,
  "system_status": {
    "mode": "offline-first",
    "local_database_available": true,
    "internet_available": true,
    "remote_server_available": false,
    "auto_sync_enabled": true,
    "last_sync": "2026-01-18 17:00:00",
    "next_sync": "2026-01-18 17:05:00"
  }
}
```

---

## ๐ ููู ูุนูู ุงููุธุงูุ

```mermaid
graph TD
    A[ุงููุณุชุฎุฏู ูุฏุฎู ุจูุงูุงุช] --> B[ุชูุญูุธ ูู SQLite ูุญููุงู]
    B --> C{ูู ููุฌุฏ ุฅูุชุฑูุชุ}
    C -->|ูุนู| D[ูุฒุงููุฉ ุชููุงุฆูุฉ ูู 5 ุฏูุงุฆู]
    C -->|ูุง| E[ุงูุนูู Offline]
    D --> F[ุฑูุน ุงูุจูุงูุงุช ููุณูุฑูุฑ]
    F --> G[ุชูุฒูู ุงูุชุญุฏูุซุงุช ูู ุงูุณูุฑูุฑ]
    E --> H[ุนูุฏ ุนูุฏุฉ ุงูุฅูุชุฑูุช]
    H --> D
```

---

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "ุงูุณูุฑูุฑ ุบูุฑ ูุชุงุญ"

**ุงูุญู:**
- โ ุงูุชุทุจูู ูุนูู offline - ูุง ูุดููุฉ!
- ุงูุจูุงูุงุช ุชูุญูุธ ูุญููุงู ูู SQLite
- ุนูุฏ ุนูุฏุฉ ุงูุฅูุชุฑูุชุ ุณุชุชู ุงููุฒุงููุฉ ุชููุงุฆูุงู

---

### ุงููุดููุฉ: "ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ ุบูุฑ ูุชุงุญุฉ"

**ุงูุญู:**
```batch
# ุชููุฆุฉ SQLite
php artisan migrate --database=sync_sqlite

# ุฃู ูู ุงููุงุฌูุฉ
http://127.0.0.1:8000/sync-monitor
# ุงุถุบุท ุนูู "ุชููุฆุฉ SQLite"
```

---

### ุงููุดููุฉ: "ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ ูุง ุชุนูู"

**ุชุญูู ูู:**
1. `.env`:
   ```env
   AUTO_SYNC_ENABLED=true
   ```

2. ุงูู Scheduler ูุนูู:
   ```batch
   php artisan schedule:work
   ```
   ุฃู
   ```batch
   start-auto-sync.bat
   ```

3. ุนุฑุถ ุขุฎุฑ ูุญุงููุฉ:
   ```batch
   php artisan sync:auto
   ```

---

## ๐ ุงููููุงุช ุงููููุฉ

```
pos/
โโโ app/
โ   โโโ Services/
โ   โ   โโโ AutoSyncService.php      # ุฎุฏูุฉ ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
โ   โ   โโโ ApiSyncService.php       # ุฎุฏูุฉ ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ
โ   โ   โโโ DatabaseSyncService.php  # ุฎุฏูุฉ ุงููุฒุงููุฉ ุจูู SQLite ู MySQL
โ   โโโ Console/Commands/
โ   โ   โโโ AutoSyncCommand.php      # ุฃูุฑ ุงููุฒุงููุฉ ุงููุฏูู
โ   โโโ Console/Kernel.php           # ุฌุฏููุฉ ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
โโโ routes/
โ   โโโ api.php                      # API Endpoints
โโโ public/
โ   โโโ sw.js                        # Service Worker (PWA)
โโโ database/
โ   โโโ sync.sqlite                  # ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ
โโโ .env                             # ุงูุฅุนุฏุงุฏุงุช
โโโ start-auto-sync.bat              # ุณูุฑุจุช ุชุดุบูู ุงููุฒุงููุฉ
โโโ OFFLINE-SYNC-GUIDE.md            # ูุฐุง ุงูููู
```

---

## ๐ API Endpoints

```
GET  /api/sync-monitor/check-health        # ูุญุต ุณุฑูุน (offline-first)
POST /api/sync-monitor/auto-sync           # ุชูููุฐ ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
POST /api/sync-monitor/force-sync          # ูุฑุถ ุงููุฒุงููุฉ ุงูุขู
GET  /api/sync-monitor/sync-health         # ูุญุต ุดุงูู (ูุญุชุงุฌ ุงุชุตุงู)
```

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:

1. ุชุญูู ูู Logs:
   ```batch
   tail -f storage/logs/laravel.log
   ```

2. ุดุบูู ุงููุฒุงููุฉ ูุฏููุงู ููุนุฑูุฉ ุงูุฎุทุฃ:
   ```batch
   php artisan sync:auto --force
   ```

3. ุชุญูู ูู ุญุงูุฉ ุงููุธุงู:
   ```
   http://127.0.0.1:8000/sync-monitor
   ```

---

## โ ุฎูุงุตุฉ

- โ ุงูุชุทุจูู ูุนูู **offline** ุจุฏูู ูุดุงูู
- โ ุงููุฒุงููุฉ ุชููุงุฆูุฉ ูู **5 ุฏูุงุฆู**
- โ ูุง ุญุงุฌุฉ ูุชุฏุฎู ุงููุณุชุฎุฏู
- โ ุงูุจูุงูุงุช ุขููุฉ ููุญููุธุฉ ูุญููุงู
- โ ูุฒุงููุฉ ุณูุณุฉ ูุดูุงูุฉ

---

**๐ ุงุณุชูุชุน ุจูุธุงู offline-first ููู ูููุซูู!**
